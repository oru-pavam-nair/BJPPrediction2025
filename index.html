<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kerala LB 2025 | BJP Performance Analysis</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Rajdhani', sans-serif;
            background-color: #050508;
            background-image: 
                linear-gradient(rgba(0, 240, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 240, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            color: #e0e0e0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .glass-panel {
            background: rgba(19, 19, 31, 0.75);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 240, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
            padding: 1.5rem;
            border-radius: 0.5rem;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0a0a0f; }
        ::-webkit-scrollbar-thumb { background: #1f2937; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #00f0ff; }

        .neon-text { text-shadow: 0 0 5px rgba(0, 240, 255, 0.5); }
        .neon-text-green { text-shadow: 0 0 8px rgba(57, 255, 20, 0.6); }
        .neon-text-yellow { text-shadow: 0 0 5px rgba(252, 238, 10, 0.5); }
        .neon-text-orange { text-shadow: 0 0 5px rgba(255, 119, 0, 0.5); }
        
        .tab-button {
            background: rgba(19, 19, 31, 0.5);
            color: #8585a3;
            border: 1px solid rgba(0, 240, 255, 0.1);
            padding: 0.75rem 1.5rem;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.875rem;
            letter-spacing: 0.1em;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            text-align: center;
            white-space: nowrap;
        }
        .tab-button:hover {
            background: rgba(0, 240, 255, 0.1);
            border-color: rgba(0, 240, 255, 0.3);
        }
        .tab-button.active {
            background: rgba(0, 240, 255, 0.2);
            color: #00f0ff;
            border-color: #00f0ff;
            box-shadow: 0 0 10px rgba(0, 240, 255, 0.3);
        }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        /* Utility Classes */
        .container { max-width: 1280px; margin: 0 auto; padding: 0 2rem; width: 100%; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }
        .grid { display: grid; }
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        .sticky { position: sticky; }
        .top-0 { top: 0; }
        .z-50 { z-index: 50; }
        .p-2 { padding: 0.5rem; }
        .p-4 { padding: 1rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-4 { margin-bottom: 1rem; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; font-weight: 600; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
        .text-4xl { font-size: 2.25rem; line-height: 2.5rem; font-weight: 700; }
        .text-5xl { font-size: 3rem; line-height: 1; font-weight: 700; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        .uppercase { text-transform: uppercase; }
        .rounded { border-radius: 0.25rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .border { border-width: 1px; }
        .border-l-4 { border-left-width: 4px; }
        .w-full { width: 100%; }
        .h-20 { height: 5rem; }
        .space-y-8 > * + * { margin-top: 2rem; }
        .overflow-x-auto { overflow-x: auto; }
        .text-white { color: #ffffff; }
        .text-gray-400 { color: #9ca3af; }
        .text-right { text-align: right; }
        .tracking-widest { letter-spacing: 0.1em; }
        .hidden { display: none; }
        .flex-grow { flex-grow: 1; }
        .space-x-4 > * + * { margin-left: 1rem; }
        .w-8 { width: 2rem; }
        .h-8 { height: 2rem; }
        .opacity-80 { opacity: 0.8; }
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .sm\:flex-row { flex-direction: row; }
        .sm\:w-48 { width: 12rem; }
        .xl\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        
        .border-cyber-primary { border-color: #00f0ff; }
        .bg-cyber-high { background-color: rgba(57, 255, 20, 0.1); }
        .text-cyber-primary { color: #00f0ff; }
        .text-cyber-high { color: #39ff14; }
        .text-cyber-medium { color: #fcee0a; }
        .text-cyber-tight { color: #ff7700; }
        .border-cyber-high { border-color: rgba(57, 255, 20, 0.5); }
        .border-t-2 { border-top-width: 2px; }
        .border-t-cyber-primary { border-top-color: #00f0ff; }
        .border-t-cyber-high { border-top-color: #39ff14; }
        .border-t-cyber-medium { border-top-color: #fcee0a; }
        .border-t-cyber-tight { border-top-color: #ff7700; }
        
        nav { 
            background: rgba(19, 19, 31, 0.75); 
            backdrop-filter: blur(12px); 
            border-bottom: 1px solid rgba(0, 240, 255, 0.3);
            padding: 1rem 0;
        }
        nav .container { 
            display: flex; 
            align-items: center; 
            justify-content: space-between;
        }
        nav svg { 
            width: 2rem; 
            height: 2rem; 
        }
        nav .flex.items-center.gap-4 {
            margin-left: auto;
        }
        
        main { flex-grow: 1; max-width: 1280px; margin: 0 auto; padding: 2rem 1rem; width: 100%; }
        main > * + * { margin-top: 2rem; }
        
        input, select {
            background: rgba(19, 19, 31, 0.75);
            border: 1px solid rgba(0, 240, 255, 0.2);
            color: #e0e0e0;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            width: 100%;
            font-family: 'Rajdhani', sans-serif;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #00f0ff;
            box-shadow: 0 0 10px rgba(0, 240, 255, 0.2);
        }
        
        .card {
            background: rgba(19, 19, 31, 0.75);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 240, 255, 0.1);
            border-radius: 0.5rem;
            padding: 1.5rem;
            transition: all 0.3s;
        }
        .card:hover {
            border-color: rgba(0, 240, 255, 0.3);
            box-shadow: 0 0 20px rgba(0, 240, 255, 0.15);
        }
        
        .animate-pulse-slow {
            animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Mobile-first responsive design */
        @media (max-width: 767px) {
            nav { padding: 0.75rem 0; }
            nav > div { padding: 0 1rem !important; flex-wrap: wrap; gap: 1rem; }
            nav h1 { font-size: 1.25rem !important; }
            nav .text-xs { font-size: 0.65rem !important; }
            nav .flex.items-center.gap-4 { width: 100%; justify-content: space-between; margin-left: 0; }
            nav .flex.items-center.gap-4 > div { font-size: 0.7rem; }
            
            main { padding: 1rem 0.5rem !important; }
            .container { padding: 0 1rem !important; }
            
            .tab-button { 
                font-size: 0.7rem !important; 
                padding: 0.5rem 0.75rem !important;
                letter-spacing: 0.05em !important;
            }
            
            .glass-panel { padding: 1rem !important; }
            
            .text-5xl { font-size: 2rem !important; }
            .text-4xl { font-size: 1.75rem !important; }
            .text-2xl { font-size: 1.25rem !important; }
            .text-xl { font-size: 1rem !important; }
            
            .grid { gap: 1rem !important; }
        }
        
        @media (min-width: 640px) {
            .sm\:flex-row { flex-direction: row; }
            .sm\:w-48 { width: 12rem; }
        }
        
        @media (min-width: 768px) {
            .md\:flex { display: flex; }
            .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .md\:w-1\/3 { width: 33.333333%; }
            .md\:w-auto { width: auto; }
            .md\:flex-row { flex-direction: row; }
        }
        
        @media (min-width: 1024px) {
            .lg\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
            .lg\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
            .lg\:col-span-2 { grid-column: span 2 / span 2; }
        }
        
        @media (min-width: 1280px) {
            .xl\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        }
    </style>
</head>
<body>

    <!-- Navbar -->
    <nav class="sticky top-0 z-50">
        <div style="max-width: 1280px; margin: 0 auto; padding: 0 2rem; display: flex; align-items: center; justify-content: space-between;">
            <div class="flex items-center gap-3">
                <i data-lucide="cpu" class="text-cyber-primary w-8 h-8"></i>
                <div>
                    <h1 class="font-headers font-bold text-2xl tracking-widest text-white neon-text">KERALA<span class="text-cyber-primary">2025</span></h1>
                    <div class="text-xs text-cyber-primary tracking-widest uppercase opacity-80">Local Body BJP Performance Prediction Engine</div>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <div class="px-3 py-1 border border-cyber-high rounded bg-cyber-high text-cyber-high text-xs font-bold tracking-widest animate-pulse-slow">
                    LIVE THREAD ANALYSIS
                </div>
                <div class="text-right">
                    <div class="text-xs text-gray-400">STATUS</div>
                    <div class="text-sm font-bold text-cyber-high">ONLINE</div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full space-y-8">

        <!-- Tab Navigation -->
        <section class="glass-panel rounded-lg p-2 border-l-4 border-cyber-primary">
            <div class="flex gap-2">
                <button onclick="switchTab('dheeraj')" id="tab-dheeraj" class="tab-button active">
                    DHEERAJ ANALYSIS
                </button>
                <button onclick="switchTab('pi-team')" id="tab-pi-team" class="tab-button">
                    PI TEAM ANALYSIS
                </button>
                <button onclick="switchTab('comparison')" id="tab-comparison" class="tab-button">
                    COMPARISON VIEW
                </button>
            </div>
        </section>

        <!-- Dheeraj Tab Content -->
        <div id="content-dheeraj" class="tab-content active">
        
        <!-- Analytics Dashboard -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Stats Card -->
            <div class="glass-panel border-t-2 border-t-cyber-primary p-6 rounded-lg relative overflow-hidden group">
                <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i data-lucide="bar-chart-2" class="w-24 h-24 text-cyber-primary"></i>
                </div>
                <h2 class="font-headers text-sm text-cyber-primary uppercase tracking-widest mb-1">Total Analysed</h2>
                <div class="text-5xl font-bold text-white neon-text mb-2" id="total-count">0</div>
                <div class="text-xs text-gray-400 mb-4">Local Bodies in Dataset</div>

                <div class="grid grid-cols-3 gap-2 border-t border-gray-700/50 pt-4">
                    <div class="text-center">
                        <div class="text-[10px] text-cyber-high uppercase tracking-wider font-bold mb-1">High</div>
                        <div class="text-xl font-bold text-white" id="safe-count">0</div>
                    </div>
                    <div class="text-center border-l border-gray-700/50">
                        <div class="text-[10px] text-cyber-medium uppercase tracking-wider font-bold mb-1">Medium</div>
                        <div class="text-xl font-bold text-white" id="medium-count">0</div>
                    </div>
                    <div class="text-center border-l border-gray-700/50">
                        <div class="text-[10px] text-cyber-tight uppercase tracking-wider font-bold mb-1">Tight</div>
                        <div class="text-xl font-bold text-white" id="tight-count">0</div>
                    </div>
                </div>
            </div>

            <!-- Chart 1: District Segmentation -->
            <div class="glass-panel p-4 rounded-lg flex flex-col border-t-2 border-t-cyber-primary">
                <h3 class="font-headers text-xs text-cyber-primary tracking-widest uppercase mb-4 text-center">District Segmentation</h3>
                <div class="relative flex-grow h-48">
                    <canvas id="districtChart"></canvas>
                </div>
            </div>

            <!-- Chart 2: Confidence Breakdown -->
            <div class="glass-panel p-4 rounded-lg flex flex-col border-t-2 border-t-cyber-primary">
                <h3 class="font-headers text-xs text-cyber-primary tracking-widest uppercase mb-4 text-center">Confidence Matrix</h3>
                <div class="relative flex-grow h-48 flex justify-center">
                    <canvas id="confidenceChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Controls -->
        <section class="glass-panel p-6 rounded-lg border-l-4 border-cyber-primary">
            <div class="flex flex-col md:flex-row gap-4 items-end md:items-center justify-between">
                
                <!-- Search -->
                <div class="w-full md:w-1/3 relative">
                    <label class="block text-xs font-headers text-cyber-primary mb-1 tracking-widest">SEARCH DATABASE</label>
                    <div class="relative">
                        <i data-lucide="search" class="absolute left-3 top-3 w-5 h-5 text-cyber-primary"></i>
                        <input type="text" id="searchInput" placeholder="Find Panchayat, Municipality..." 
                            class="w-full bg-cyber-black border border-cyber-primary/30 text-white pl-10 pr-4 py-2 rounded focus:outline-none focus:border-cyber-primary focus:shadow-[0_0_10px_rgba(0,240,255,0.3)] transition-all font-body text-lg placeholder-gray-600">
                    </div>
                </div>

                <!-- Filters -->
                <div class="flex flex-col sm:flex-row gap-4 w-full md:w-auto">
                    <div class="w-full sm:w-48">
                        <label class="block text-xs font-headers text-cyber-primary mb-1 tracking-widest">DISTRICT FILTER</label>
                        <select id="districtFilter" class="w-full bg-cyber-black border border-cyber-primary/30 text-white px-4 py-2 rounded focus:outline-none focus:border-cyber-primary appearance-none cursor-pointer hover:bg-cyber-dark transition-colors">
                            <option value="All">All Districts</option>
                            <!-- Options populated via JS -->
                        </select>
                    </div>

                    <div class="w-full sm:w-48">
                        <label class="block text-xs font-headers text-cyber-primary mb-1 tracking-widest">PROBABILITY</label>
                        <select id="probFilter" class="w-full bg-cyber-black border border-cyber-primary/30 text-white px-4 py-2 rounded focus:outline-none focus:border-cyber-primary appearance-none cursor-pointer hover:bg-cyber-dark transition-colors">
                            <option value="All">All Probabilities</option>
                            <option value="High" class="text-cyber-high">High Probability</option>
                            <option value="Medium" class="text-cyber-medium">Medium Probability</option>
                            <option value="Tight" class="text-cyber-tight">Tight Fight</option>
                        </select>
                    </div>
                </div>
            </div>
        </section>

        <!-- Data Grid -->
        <section id="gridContainer" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-12">
            <!-- Cards will be injected here -->
        </section>
        
        </div>
        <!-- End Dheeraj Tab -->
        
        <!-- PI Team Tab Content -->
        <div id="content-pi-team" class="tab-content">
            
            <!-- PI Team Stats -->
            <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- PI Team Stats Card -->
                <div class="glass-panel border-t-2 border-t-cyber-primary p-6 rounded-lg">
                    <h2 class="font-headers text-sm text-cyber-primary uppercase tracking-widest mb-1">PI Team Coverage</h2>
                    <div class="text-5xl font-bold text-white neon-text mb-2" id="pi-total-count">0</div>
                    <div class="text-xs text-gray-400 mb-4">Local Bodies Analyzed</div>
                    
                    <div class="grid grid-cols-3 gap-2 border-t border-gray-700/50 pt-4">
                        <div class="text-center">
                            <div class="text-[10px] text-cyber-high uppercase tracking-wider font-bold mb-1">Ahead</div>
                            <div class="text-xl font-bold text-white" id="pi-ahead-count">0</div>
                        </div>
                        <div class="text-center border-l border-gray-700/50">
                            <div class="text-[10px] text-cyber-medium uppercase tracking-wider font-bold mb-1">Deadheat</div>
                            <div class="text-xl font-bold text-white" id="pi-deadheat-count">0</div>
                        </div>
                        <div class="text-center border-l border-gray-700/50">
                            <div class="text-[10px] text-cyber-tight uppercase tracking-wider font-bold mb-1">Behind</div>
                            <div class="text-xl font-bold text-white" id="pi-behind-count">0</div>
                        </div>
                    </div>
                </div>
                
                <!-- PI Team District Chart -->
                <div class="glass-panel p-4 rounded-lg flex flex-col border-t-2 border-t-cyber-primary">
                    <h3 class="font-headers text-xs text-cyber-primary tracking-widest uppercase mb-4 text-center">PI Team District Coverage</h3>
                    <div class="relative flex-grow h-48">
                        <canvas id="piDistrictChart"></canvas>
                    </div>
                </div>
                
                <!-- PI Team Seat Predictions Chart -->
                <div class="glass-panel p-4 rounded-lg flex flex-col border-t-2 border-t-cyber-primary">
                    <h3 class="font-headers text-xs text-cyber-primary tracking-widest uppercase mb-4 text-center">Seat Call Distribution</h3>
                    <div class="relative flex-grow h-48 flex justify-center">
                        <canvas id="piSeatCallChart"></canvas>
                    </div>
                </div>
            </section>
            
            <!-- PI Team Filters -->
            <section class="glass-panel p-6 rounded-lg border-l-4 border-cyber-primary mt-8">
                <div class="flex flex-col md:flex-row gap-4 items-end md:items-center justify-between">
                    <div class="w-full md:w-1/3 relative">
                        <label class="block text-xs font-headers text-cyber-primary mb-1 tracking-widest">SEARCH DATABASE</label>
                        <div class="relative">
                            <i data-lucide="search" class="absolute left-3 top-3 w-5 h-5 text-cyber-primary"></i>
                            <input type="text" id="piSearchInput" placeholder="Find Panchayat, Municipality..." 
                                class="w-full bg-cyber-black border border-cyber-primary/30 text-white pl-10 pr-4 py-2 rounded focus:outline-none focus:border-cyber-primary focus:shadow-[0_0_10px_rgba(0,240,255,0.3)] transition-all font-body text-lg placeholder-gray-600">
                        </div>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row gap-4 w-full md:w-auto">
                        <div class="w-full sm:w-48">
                            <label class="block text-xs font-headers text-cyber-primary mb-1 tracking-widest">DISTRICT FILTER</label>
                            <select id="piDistrictFilter" class="w-full bg-cyber-black border border-cyber-primary/30 text-white px-4 py-2 rounded focus:outline-none focus:border-cyber-primary appearance-none cursor-pointer hover:bg-cyber-dark transition-colors">
                                <option value="All">All Districts</option>
                            </select>
                        </div>
                        
                        <div class="w-full sm:w-48">
                            <label class="block text-xs font-headers text-cyber-primary mb-1 tracking-widest">SEAT CALL</label>
                            <select id="piSeatCallFilter" class="w-full bg-cyber-black border border-cyber-primary/30 text-white px-4 py-2 rounded focus:outline-none focus:border-cyber-primary appearance-none cursor-pointer hover:bg-cyber-dark transition-colors">
                                <option value="All">All Status</option>
                                <option value="BJP Ahead" class="text-cyber-high">BJP Ahead</option>
                                <option value="Deadheat" class="text-cyber-medium">Deadheat</option>
                                <option value="BJP Behind" class="text-cyber-tight">BJP Behind</option>
                            </select>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- PI Team Data Grid -->
            <section id="piGridContainer" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-12 mt-8">
                <!-- PI Team cards will be injected here -->
            </section>
            
        </div>
        <!-- End PI Team Tab -->
        
        <!-- Comparison Tab Content -->
        <div id="content-comparison" class="tab-content">
            
            <!-- Comparison Stats -->
            <section class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <div class="glass-panel border-t-2 border-t-cyber-primary p-6 rounded-lg">
                    <h2 class="font-headers text-sm text-cyber-primary uppercase tracking-widest mb-1">Total Coverage</h2>
                    <div class="text-4xl font-bold text-white neon-text mb-2" id="comp-total">0</div>
                    <div class="text-xs text-gray-400">Unique Local Bodies</div>
                </div>
                
                <div class="glass-panel border-t-2 border-t-cyber-high p-6 rounded-lg">
                    <h2 class="font-headers text-sm text-cyber-high uppercase tracking-widest mb-1">Both Sources</h2>
                    <div class="text-4xl font-bold text-white neon-text-green mb-2" id="comp-both">0</div>
                    <div class="text-xs text-gray-400">Analyzed by Both</div>
                </div>
                
                <div class="glass-panel border-t-2 border-t-cyber-medium p-6 rounded-lg">
                    <h2 class="font-headers text-sm text-cyber-medium uppercase tracking-widest mb-1">Dheeraj Only</h2>
                    <div class="text-4xl font-bold text-white neon-text-yellow mb-2" id="comp-dheeraj-only">0</div>
                    <div class="text-xs text-gray-400">Unique to Dheeraj</div>
                </div>
                
                <div class="glass-panel border-t-2 border-t-cyber-tight p-6 rounded-lg">
                    <h2 class="font-headers text-sm text-cyber-tight uppercase tracking-widest mb-1">PI Team Only</h2>
                    <div class="text-4xl font-bold text-white neon-text-orange mb-2" id="comp-pi-only">0</div>
                    <div class="text-xs text-gray-400">Unique to PI Team</div>
                </div>
            </section>
            
            <!-- Comparison Charts -->
            <section class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
                <!-- Source Coverage Chart -->
                <div class="glass-panel p-6 rounded-lg border-l-4 border-cyber-primary">
                    <h2 class="font-headers text-xl text-cyber-primary uppercase tracking-widest mb-6">Source Coverage</h2>
                    <div class="relative" style="height: 300px;">
                        <canvas id="sourceCoverageChart"></canvas>
                    </div>
                </div>
                
                <!-- Confidence Comparison Chart -->
                <div class="glass-panel p-6 rounded-lg border-l-4 border-cyber-high">
                    <h2 class="font-headers text-xl text-cyber-high uppercase tracking-widest mb-6">Prediction Confidence Comparison</h2>
                    <div class="relative" style="height: 300px;">
                        <canvas id="confidenceComparisonChart"></canvas>
                    </div>
                </div>
                
                <!-- District Coverage Comparison -->
                <div class="glass-panel p-6 rounded-lg border-l-4 border-cyber-medium col-span-1 lg:col-span-2">
                    <h2 class="font-headers text-xl text-cyber-medium uppercase tracking-widest mb-6">District-wise Coverage Comparison</h2>
                    <div class="relative" style="height: 400px;">
                        <canvas id="districtCoverageChart"></canvas>
                    </div>
                </div>
            </section>
            
            <!-- Comparison Filters -->
            <section class="glass-panel p-6 rounded-lg border-l-4 border-cyber-primary mt-8">
                <div class="flex flex-col md:flex-row gap-4 items-end md:items-center justify-between">
                    <div class="w-full md:w-1/3 relative">
                        <label class="block text-xs font-headers text-cyber-primary mb-1 tracking-widest">SEARCH DATABASE</label>
                        <div class="relative">
                            <i data-lucide="search" class="absolute left-3 top-3 w-5 h-5 text-cyber-primary"></i>
                            <input type="text" id="compSearchInput" placeholder="Find Panchayat, Municipality..." 
                                class="w-full bg-cyber-black border border-cyber-primary/30 text-white pl-10 pr-4 py-2 rounded focus:outline-none focus:border-cyber-primary focus:shadow-[0_0_10px_rgba(0,240,255,0.3)] transition-all font-body text-lg placeholder-gray-600">
                        </div>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row gap-4 w-full md:w-auto">
                        <div class="w-full sm:w-48">
                            <label class="block text-xs font-headers text-cyber-primary mb-1 tracking-widest">DISTRICT FILTER</label>
                            <select id="compDistrictFilter" class="w-full bg-cyber-black border border-cyber-primary/30 text-white px-4 py-2 rounded focus:outline-none focus:border-cyber-primary appearance-none cursor-pointer hover:bg-cyber-dark transition-colors">
                                <option value="All">All Districts</option>
                            </select>
                        </div>
                        
                        <div class="w-full sm:w-48">
                            <label class="block text-xs font-headers text-cyber-primary mb-1 tracking-widest">VIEW TYPE</label>
                            <select id="compViewFilter" class="w-full bg-cyber-black border border-cyber-primary/30 text-white px-4 py-2 rounded focus:outline-none focus:border-cyber-primary appearance-none cursor-pointer hover:bg-cyber-dark transition-colors">
                                <option value="All">All Local Bodies</option>
                                <option value="Both">Both Sources Available</option>
                                <option value="DheerajOnly">Dheeraj Only</option>
                                <option value="PIOnly">PI Team Only</option>
                            </select>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Comparison Grid -->
            <section id="compGridContainer" class="grid grid-cols-1 gap-6 pb-12 mt-8">
                <!-- Comparison cards will be injected here -->
            </section>
            
        </div>
        <!-- End Comparison Tab -->

    </main>

    <footer class="border-t border-gray-800 bg-cyber-black py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-cyber-dim font-headers text-sm">DATA SOURCE: THREAD ID 1990759711000735989</p>
            <p class="text-gray-600 text-xs mt-2 font-body">Analysis by @addheeraj | Visualization Generated via Gemini 2.0 By @oru_pavam_nair</p>
        </div>
    </footer>

    <!-- LOGIC -->
    <script>
        // Initialize Icons
        lucide.createIcons();

        // --- FUZZY MATCHING FUNCTION ---
        function fuzzyMatch(str1, str2) {
            if (!str1 || !str2) return 0;
            const s1 = str1.toLowerCase().trim().replace(/[^a-z0-9]/g, '');
            const s2 = str2.toLowerCase().trim().replace(/[^a-z0-9]/g, '');
            
            if (s1 === s2) return 1.0;
            
            // Levenshtein distance
            const len1 = s1.length, len2 = s2.length;
            const matrix = Array(len1 + 1).fill(null).map(() => Array(len2 + 1).fill(0));
            
            for (let i = 0; i <= len1; i++) matrix[i][0] = i;
            for (let j = 0; j <= len2; j++) matrix[0][j] = j;
            
            for (let i = 1; i <= len1; i++) {
                for (let j = 1; j <= len2; j++) {
                    const cost = s1[i-1] === s2[j-1] ? 0 : 1;
                    matrix[i][j] = Math.min(
                        matrix[i-1][j] + 1,
                        matrix[i][j-1] + 1,
                        matrix[i-1][j-1] + cost
                    );
                }
            }
            
            const distance = matrix[len1][len2];
            const maxLen = Math.max(len1, len2);
            return maxLen === 0 ? 1 : 1 - (distance / maxLen);
        }
        
        function findBestMatch(name, list) {
            let bestMatch = null;
            let bestScore = 0;
            
            for (const item of list) {
                const score = fuzzyMatch(name, item.name);
                if (score > bestScore && score > 0.75) { // 75% similarity threshold
                    bestScore = score;
                    bestMatch = item;
                }
            }
            
            return bestMatch;
        }

        // --- DHEERAJ DATASET ---
        const rawData = [
            { name: "Chemmaruthy", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "85%+", ls_lead: "61%", note: "BJP led 61% of booths. Main opposition (6 seats). Grassroot growth." },
            { name: "Kodungallur", district: "Thrissur", type: "Municipality", prob: "High", h_dem: "High", ls_lead: "High", note: "Lost by 1 seat in 2020. Highest vote share in state. Sympathy wave expected." },
            { name: "Madhur", district: "Kasargod", type: "Panchayat", prob: "Medium", h_dem: "Favorable", ls_lead: "N/A", note: "Ruling since 1979. Communalized fight vs Muslim League. Demography still favorable." },
            { name: "Vilappil", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "High", ls_lead: "42%", note: "BJP main opposition (7 seats). Led 42% booths in LS. Triangular fight." },
            { name: "Poruvazhy", district: "Kollam", type: "Panchayat", prob: "High", h_dem: "Majority", ls_lead: "N/A", note: "Expecting Hindu counter polarization vs SDPI support. Ms concentrated in few wards." },
            { name: "Thazhakkara", district: "Alappuzha", type: "Panchayat", prob: "High", h_dem: "N/A", ls_lead: "N/A", note: "BJP likely to win outright. Good grassroots presence. Current LDF rule weak." },
            { name: "Kuttoor", district: "Pathanamthitta", type: "Panchayat", prob: "Medium", h_dem: "N/A", ls_lead: "N/A", note: "Ruled in 2015, lost 2020. H consolidation + some C vote expected." },
            { name: "Aymanam", district: "Kottayam", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "N/A", note: "Main opposition. Delimitation created pro-BJP ward. Increasing Ezhava penetration." },
            { name: "Parli", district: "Palakkad", type: "Panchayat", prob: "High", h_dem: "N/A", ls_lead: "59%", note: "Upcoming stronghold. Led 59% booths in LS. Almost sure win." },
            { name: "Attingal", district: "Trivandrum", type: "Municipality", prob: "High", h_dem: "High (Urban)", ls_lead: "88%", note: "Natural BJP territory. Led 88% booths in LS. Likely to breach CPM fortress." },
            { name: "Vallachira", district: "Thrissur", type: "Panchayat", prob: "High", h_dem: "Heavy", ls_lead: "88%", note: "Led 88% booths in LS. Expecting clear victory in LDF stronghold." },
            { name: "Thiruvandoor", district: "Alappuzha", type: "Panchayat", prob: "High", h_dem: "Majority", ls_lead: "N/A", note: "Stronghold. Expecting decisive verdict favoring BJP." },
            { name: "Thazhva", district: "Kollam", type: "Panchayat", prob: "Tight", h_dem: "Dominant", ls_lead: "50%", note: "Led 50% booths. Likely to edge ahead in tight 3-corner fight." },
            { name: "Mudakkal", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "88%", ls_lead: "69%", note: "Match made in heaven. Led 69% booths. Most sure pickup." },
            { name: "Mutholy", district: "Kottayam", type: "Panchayat", prob: "Medium", h_dem: "Mixed H/C", ls_lead: "N/A", note: "Delimitation tricky, but expecting plurality on H consolidation." },
            { name: "Tripunithura", district: "Ernakulam", type: "Municipality", prob: "Tight", h_dem: "80%", ls_lead: "N/A", note: "Won 2 byelections recently. Edge past LDF on anti-incumbency." },
            { name: "Ranny Perunadu", district: "Pathanamthitta", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "Good", note: "Seats increased 0->5 (2020). Can gain 2-3 more seats." },
            { name: "Kollayil", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "50%", note: "Strong BJP area. Capture from LDF on anti-incumbency." },
            { name: "Ambalappuzha South", district: "Alappuzha", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "52%", note: "Easy pickup. #1 in LS with 37% vote." },
            { name: "Enmakaje", district: "Kasargod", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "Strong", note: "Regain stronghold via H consolidation vs 3-way split." },
            { name: "Nedavathur", district: "Kollam", type: "Panchayat", prob: "High", h_dem: "Heavily H", ls_lead: "N/A", note: "Won plurality 2020. Sympathy + LDF/UDF instability favors BJP." },
            { name: "Kaliyoor", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Stronghold", ls_lead: "77%", note: "Astounding 77% booth lead. Ousted by rebel/alliance in 2023, likely to win back." },
            { name: "Vattavada", district: "Idukki", type: "Panchayat", prob: "Tight", h_dem: "Tribal H", ls_lead: "N/A", note: "Heavy grassroots work. 3-cornered race win likely." },
            { name: "Chirakkadavu", district: "Kottayam", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Triangular contest benefits BJP. Anti-incumbency factor." },
            { name: "Ottoor", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "90%", ls_lead: "High", note: "Highest H% in district. Natural territory. Comfortable win." },
            { name: "Budhanur", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "N/A", note: "Breakthrough expected. Was 2nd in 6 wards in 2020." },
            { name: "Edavilangu", district: "Thrissur", type: "Panchayat", prob: "High", h_dem: "Majority", ls_lead: "Strong", note: "#1 among Hs. Win on H consolidation." },
            { name: "Cherukol", district: "Pathanamthitta", type: "Panchayat", prob: "Medium", h_dem: "Minority", ls_lead: "N/A", note: "Currently ruling. Narrow path to retain via H wards." },
            { name: "Athiyanoor", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "64%", note: "Led 64% booths. Final winning push expected." },
            { name: "Perinad", district: "Kollam", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "3-cornered fight. Can wrest 2-3 wards for plurality." },
            { name: "Karthikapally", district: "Alappuzha", type: "Panchayat", prob: "High", h_dem: "86%", ls_lead: "86%", note: "Easy win. Trailing LDF by just 1 seat currently." },
            { name: "Thiruvilwamala", district: "Thrissur", type: "Panchayat", prob: "High", h_dem: "Heavy", ls_lead: "Strong", note: "Tied at 6 in 2020. Clear victory expected." },
            { name: "Maranallur", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "59%", note: "Regain dominance in 3-cornered fight." },
            { name: "Nedumpram", district: "Pathanamthitta", type: "Panchayat", prob: "High", h_dem: "Majority", ls_lead: "N/A", note: "Regain stronghold lost in 2020." },
            { name: "Palakkad Municipality", district: "Palakkad", type: "Municipality", prob: "High", h_dem: "Dominant", ls_lead: "N/A", note: "Ruling since 2015. 3rd time win on H consolidation." },
            { name: "Chirakkara", district: "Kollam", type: "Panchayat", prob: "Tight", h_dem: "90%", ls_lead: "31%", note: "Ripe for inroads. Win plurality in tight 3-way." },
            { name: "Karavaram", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "N/A", note: "Retain with plurality. Growth from 0 (2015) to 9 (2020)." },
            { name: "Paivalike", district: "Kasargod", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Tactical M voting vs BJP. Narrow majority expected." },
            { name: "Parappookara", district: "Thrissur", type: "Panchayat", prob: "High", h_dem: "75%+", ls_lead: "86%", note: "Staggering 46% vote share LS. Easy breach of CPM hold." },
            { name: "Kallara", district: "Kottayam", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Triangular contest benefits BJP. Chance to win plurality." },
            { name: "Pattazhi", district: "Kollam", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Can emerge #1 if maximises H performance." },
            { name: "Chettikulangara", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "87%", ls_lead: "57%", note: "LDF bastion. Win possible based on grassroots." },
            { name: "Perumkadavila", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "38% leads", note: "#1 in LS (35% vote). Win plurality." },
            { name: "Akkathethara", district: "Palakkad", type: "Panchayat", prob: "High", h_dem: "High", ls_lead: "71%", note: "Story of H Kerala. CPM stronghold crumbling. BJP pickup." },
            { name: "Venmony", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "N/A", note: "Had 7 2nd places. Win likely based on trend." },
            { name: "Kaviyoor", district: "Pathanamthitta", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "N/A", note: "Won plurality 2020. Narrow path but expect plurality." },
            { name: "Meenja", district: "Kasargod", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Overcome 4 party M alliance (SDPI IUML INC CPM)." },
            { name: "Anchal", district: "Kollam", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "Creditable", note: "Key growth area. Decent chance to upset LDF." },
            { name: "Varkala", district: "Trivandrum", type: "Municipality", prob: "Medium", h_dem: "Ezhava Home", ls_lead: "71%", note: "Spiritual home of Ezhavas. Overcome tactical M voting." },
            { name: "Cherpu", district: "Thrissur", type: "Panchayat", prob: "High", h_dem: "Majority", ls_lead: "79%", note: "LS sweep (44% vote). Should win in 3-way." },
            { name: "Pallichal", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Heavily H", ls_lead: "60%", note: "Anti-incumbency to help topple LDF." },
            { name: "Puliyur", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "N/A", note: "Regressed in 2020. Decent chance if anti-incumbency plays out." },
            { name: "Puliyur (Analysis 2)", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "N/A", note: "Came close in 2015, regressed in 2020. Anti-incumbency opportunity." },
            { name: "Kalluvathakal", district: "Kollam", type: "Panchayat", prob: "Medium", h_dem: "Heavily H", ls_lead: "Good", note: "Won plurality 2020. Win again despite local issues." },
            { name: "Vaniyamkulam", district: "Palakkad", type: "Panchayat", prob: "Medium", h_dem: "High", ls_lead: "Good", note: "CPM fort. Decent chance of upset win." },
            { name: "Kottukal", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "56%", note: "#1 in LS. Decent chance in triangular fight." },
            { name: "Nattika", district: "Thrissur", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "91%", note: "Momentum post SG Thrissur win. 91% booth lead." },
            { name: "Edamalakudy", district: "Idukki", type: "Panchayat", prob: "High", h_dem: "Tribal", ls_lead: "N/A", note: "Emerging hotspot. Byelection success. Likely win." },
            { name: "Pandalam Thekkekara", district: "Pathanamthitta", type: "Panchayat", prob: "High", h_dem: "Heavily H", ls_lead: "50%", note: "Sabarimala sentiment favors BJP." },
            { name: "Kadakavoor", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "85%+", ls_lead: "70%", note: "Strongest in Attingal LS. Demography leads to win." },
            { name: "Haripad", district: "Alappuzha", type: "Municipality", prob: "High", h_dem: "Heavily H", ls_lead: "67%", note: "Should cross double digits. Plurality likely." },
            { name: "Avinissery", district: "Thrissur", type: "Panchayat", prob: "High", h_dem: "Majority", ls_lead: "79%", note: "Biggest stronghold in Thrissur. Safe." },
            { name: "Kidangoor", district: "Kottayam", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Win plurality. 8/16 wards winnable." },
            { name: "Mylom", district: "Kollam", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "N/A", note: "CPM bastion. Anti-incumbency could lead to #1." },
            { name: "Ottasekharamangalam", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "64%", ls_lead: "34% vote", note: "#1 among Hs. Consolidate CPM leaning H vote." },
            { name: "Badiadka", district: "Kasargod", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Narrow path exists. Wrest H seats from INC/CPM." },
            { name: "Chennithala-Tripperumuthara", district: "Alappuzha", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "N/A", note: "Expect clear win. Riddled with instability." },
            { name: "Sree Narayanapuram", district: "Thrissur", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Tactical M voting. Close battle. Chance if H increases." },
            { name: "Malayinkeezhu", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Heavily H", ls_lead: "70%", note: "Breakthrough expected. 40% vote in LS." },
            { name: "Thycattusery", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "75%", ls_lead: "N/A", note: "Main opposition. Decent chance to become #1." },
            { name: "Pandalam", district: "Pathanamthitta", type: "Municipality", prob: "High", h_dem: "Dominant", ls_lead: "N/A", note: "Retain with plurality. Anti-LDF environment." },
            { name: "Pavithreshwaram", district: "Kollam", type: "Panchayat", prob: "Tight", h_dem: "81%", ls_lead: "N/A", note: "Chance to emerge #1 in 3 cornered fight." },
            { name: "Balaramapuram", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "65%", note: "Easy win given grassroot trends." },
            { name: "Engandiyoor", district: "Thrissur", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "78%", note: "LS 'on steroids'. Good chance to win." },
            { name: "Ottapalam", district: "Palakkad", type: "Municipality", prob: "Tight", h_dem: "67%", ls_lead: "50%", note: "Upset plurality win possible via H consolidation." },
            { name: "Muthukulam", district: "Alappuzha", type: "Panchayat", prob: "High", h_dem: "90%+", ls_lead: "76%", note: "Victory likely. Led 76% booths in LS." },
            { name: "Aryankode", district: "Trivandrum", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "35% leads", note: "Chance to win plurality depending on C vote split." },
            { name: "Belur", district: "Kasargod", type: "Panchayat", prob: "High", h_dem: "Very High", ls_lead: "N/A", note: "Safest local body in Kerala. Sure win." },
            { name: "Velavoor", district: "Kottayam", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "30% vote", note: "Decent chance of winning plurality in tight 3 way." },
            { name: "Panayam", district: "Kollam", type: "Panchayat", prob: "Medium", h_dem: "Heavily H", ls_lead: "N/A", note: "Good chance given grassroot growth." },
            { name: "Ala", district: "Alappuzha", type: "Panchayat", prob: "Tight", h_dem: "69%", ls_lead: "N/A", note: "Breakthrough potential. Close to victory in 2020." },
            { name: "Pothencode", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "34% vote", note: "Main opposition. Should be a win." },
            { name: "Poomangalam", district: "Thrissur", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "75%", note: "Swept H areas in LS. Flip from LDF." },
            { name: "Shornur", district: "Palakkad", type: "Municipality", prob: "Medium", h_dem: "Heavily H", ls_lead: "34% vote", note: "Red fort breach possible. Victory possible." },
            { name: "Vakkom", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Heavily H", ls_lead: "69%", note: "Good chance due to demography and growth." },
            { name: "Punnapra North", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "54%", note: "Crushed CPM in LS leads. Bastion might fall." },
            { name: "Chathanoor", district: "Kollam", type: "Panchayat", prob: "Tight", h_dem: "Dominant", ls_lead: "N/A", note: "Chance to win in 3 cornered fight." },
            { name: "Malampuzha", district: "Palakkad", type: "Panchayat", prob: "High", h_dem: "Dominated", ls_lead: "34% vote", note: "CPM fortress crumbling. Expecting victory." },
            { name: "Manamboor", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "58%", note: "Winning chance in 10-12 wards." },
            { name: "Malayalapuzha", district: "Pathanamthitta", type: "Panchayat", prob: "Tight", h_dem: "Dominated", ls_lead: "35% leads", note: "Win if Sabarimala sentiment works against CPM." },
            { name: "Elampalloor", district: "Kollam", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "N/A", note: "Decent chance to win plurality by sweeping H areas." },
            { name: "Karalam", district: "Thrissur", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "67%", note: "Decent chance to upset CPM here." },
            { name: "Vilavoorkal", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "63%", note: "Clear win expected after 2 tied #1s." },
            { name: "Pathiyoor", district: "Alappuzha", type: "Panchayat", prob: "High", h_dem: "85%+", ls_lead: "70%", note: "Win very much possible. Main opposition." },
            { name: "Kollengode", district: "Palakkad", type: "Panchayat", prob: "Medium", h_dem: "Heavily H", ls_lead: "Good", note: "CPM stronghold. Surprise upset potential." },
            { name: "Kulanada", district: "Pathanamthitta", type: "Panchayat", prob: "High", h_dem: "Majority", ls_lead: "45%", note: "Expecting hatrick victory." },
            { name: "Vamanapuram", district: "Trivandrum", type: "Panchayat", prob: "Tight", h_dem: "Heavily H", ls_lead: "35% vote", note: "Demography favors BJP in close 3 way fight." },
            { name: "Kumbadaje", district: "Kasargod", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Narrow path to power. Flip Muniyoor ward." },
            { name: "Mavelikkara Thamarakulam", district: "Alappuzha", type: "Panchayat", prob: "Tight", h_dem: "Dominant", ls_lead: "N/A", note: "Good chance to become #1 in triangular fight." },
            { name: "Trivandrum Corporation", district: "Trivandrum", type: "Corporation", prob: "High", h_dem: "Heartbeat of H", ls_lead: "N/A", note: "Epitome of H shift. Clear majority 51+ projected." },
            { name: "Padiyoor", district: "Thrissur", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "67%", note: "Good chance to flip from LDF." },
            { name: "Poonjar", district: "Kottayam", type: "Panchayat", prob: "Tight", h_dem: "Mixed", ls_lead: "50%", note: "Can win if PCG factor works and gets C vote." },
            { name: "Elakamon", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "32% vote", note: "Can win if consolidates anti-LDF H vote." },
            { name: "Mavelikkara", district: "Alappuzha", type: "Municipality", prob: "High", h_dem: "Dominant", ls_lead: "N/A", note: "Tied to win shift. Good chance." },
            { name: "Kulakkada", district: "Kollam", type: "Panchayat", prob: "Medium", h_dem: "Heavily H", ls_lead: "N/A", note: "Chance to win depending on anti-incumbency." },
            { name: "Ayiroor", district: "Pathanamthitta", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "50%", note: "Good chance to flip from LDF." },
            { name: "Cheriyunoor", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "80%", ls_lead: "56%", note: "Can win if it puts good effort. Latent H base." },
            { name: "Kunnamakulam", district: "Thrissur", type: "Municipality", prob: "Medium", h_dem: "Majority", ls_lead: "42% H vote", note: "Win plurality if H votes consolidate." },
            { name: "Pallickathodu", district: "Kottayam", type: "Panchayat", prob: "High", h_dem: "Majority", ls_lead: "N/A", note: "Stronghold. Expecting clear victory." },
            { name: "Cheruthana", district: "Alappuzha", type: "Panchayat", prob: "Tight", h_dem: "Dominant", ls_lead: "45%", note: "Win plurality in 3 cornered if LS momentum sustains." },
            { name: "Manglapuram", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "43%", note: "Decent chance to flip from LDF. 2 close losses in 2020." },
            { name: "Kadaradka", district: "Kasargod", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "N/A", note: "Win plurality or majority. Dominant force." },
            { name: "Vadanapilly", district: "Thrissur", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "45%", note: "Chance if H shift offsets M consolidation." },
            { name: "Kunnathur", district: "Kollam", type: "Panchayat", prob: "Tight", h_dem: "Heavily H", ls_lead: "N/A", note: "Good chance to win in triangular fight." },
            { name: "Pandanad", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "N/A", note: "Win plurality again despite local issues." },
            { name: "Kottanad", district: "Pathanamthitta", type: "Panchayat", prob: "Tight", h_dem: "Equal H/C", ls_lead: "29% vote", note: "Narrow chance to win plurality based on minority split." },
            { name: "Venganoor", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "62%", note: "Regain stronghold. Led 62% booths." },
            { name: "Chowannur", district: "Thrissur", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "25% vote", note: "Decent chance of flipping from LDF." },
            { name: "Krishnapuram", district: "Alappuzha", type: "Panchayat", prob: "Tight", h_dem: "70%", ls_lead: "55%", note: "Decent chance of plurality in 3 way fight." },
            { name: "Thidanadu", district: "Kottayam", type: "Panchayat", prob: "Tight", h_dem: "C Dominant", ls_lead: "38%", note: "Win plurality if PCG factor works." },
            { name: "Elappuly", district: "Palakkad", type: "Panchayat", prob: "Tight", h_dem: "Heavily H", ls_lead: "#2", note: "Viable path to win plurality in 3 cornered fight." },
            { name: "Mullurkara", district: "Thrissur", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "N/A", note: "Chance to win plurality depending on M vote." },
            { name: "Kalikkadu", district: "Trivandrum", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "64%", note: "Retain comfortably." },
            { name: "Kottamkara", district: "Kollam", type: "Panchayat", prob: "Medium", h_dem: "66%H 31%M", ls_lead: "N/A", note: "BJP strong among Hs. Main but distant opposition at 4 seats. 2nd or within touching distance of #1 in many wards. Surprise win if anti-incumbency works against LDF." },
            { name: "Madakkathara", district: "Thrissur", type: "Panchayat", prob: "Medium", h_dem: "H dominant", ls_lead: "62%", note: "CPM stronghold. BJP main but distant opposition. 41% vote in LS. Tougher, but can win if BJP consolidates H vote and C split happens." },
            { name: "Pudur", district: "Palakkad", type: "Panchayat", prob: "Medium", h_dem: "Heavily H tribal", ls_lead: "26% vote", note: "BJP main opposition with 4 seats to LDF's 6 and UDF 2. Growing presence. Decent chance of flipping from LDF." },
            { name: "Vellanad", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "H dominant", ls_lead: "43%", note: "Won 3 seats in 2015, only 1 in 2020 with 6 2nd places. Outside chance if local anti-incumbency against UDF works." },
            { name: "Purakkad", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "81%", ls_lead: "56%", note: "Finished 3rd in 2020. #1 in LS with 37% vote. Campaign focusing on LDF misgovernance can possibly deliver win." },
            { name: "Manalur", district: "Thrissur", type: "Panchayat", prob: "Medium", h_dem: "H dominant", ls_lead: "77%", note: "Won 3 seats in 2020. LS increased to 43% vote. Reasonable chance if builds on LS gains at grassroots." },
            { name: "Kareepra", district: "Kollam", type: "Panchayat", prob: "Medium", h_dem: "Heavily H", ls_lead: "N/A", note: "Flip if anti-incumbency plays out." },
            { name: "Omalloor", district: "Pathanamthitta", type: "Panchayat", prob: "Tight", h_dem: "Majority", ls_lead: "#2", note: "Win plurality if H consolidation increases." },
            { name: "Neelamperoor", district: "Alappuzha", type: "Panchayat", prob: "Medium", h_dem: "Dominant", ls_lead: "N/A", note: "Decent chance of flipping." },
            { name: "Paralam", district: "Thrissur", type: "Panchayat", prob: "Medium", h_dem: "Majority", ls_lead: "68%", note: "Decent chance to win plurality." },
            { name: "Pulimath", district: "Trivandrum", type: "Panchayat", prob: "Medium", h_dem: "Heavily H", ls_lead: "62%", note: "Upset potential if latent H base activates." },
            { name: "Vorkady", district: "Kasargod", type: "Panchayat", prob: "Tight", h_dem: "Minority H", ls_lead: "N/A", note: "Slim chance depending on H consolidation and M split." },
            { name: "Kodamthuruthu", district: "Alappuzha", type: "Panchayat", prob: "High", h_dem: "Dominant", ls_lead: "N/A", note: "Win in current environment. Oust recovery." },
            { name: "Kottangal", district: "Pathanamthitta", type: "Panchayat", prob: "Tight", h_dem: "Minority H", ls_lead: "29% vote", note: "Narrow chance to win plurality based on split of minority votes." }
        ];

        // --- PI TEAM DATASET ---
        const piTeamData = [
            { name: "Badiadka", district: "Kasargod", type: "Grama Panchayat", team: "Team 3", date: "3 December", seatCall: "Deadheat", bjpSeats: "9", ldfSeats: "2", udfSeats: "9", others: "1", reasoning: "The BJP is expected to improve its performance and is running a robust, targeted campaign..." },
            { name: "Bellur", district: "Kasargod", type: "Grama Panchayat", team: "Team 3", date: "5 December", seatCall: "", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Kasaragod", district: "Kasargod", type: "Municipality", team: "Team 3", date: "3 December", seatCall: "BJP Behind", bjpSeats: "13", ldfSeats: "", udfSeats: "19", others: "4", reasoning: "The BJP is certain to win 13 wards and is actively contesting three others..." },
            { name: "Madhur", district: "Kasargod", type: "Grama Panchayat", team: "Team 3", date: "3 December", seatCall: "BJP Ahead", bjpSeats: "13", ldfSeats: "2", udfSeats: "6", others: "", reasoning: "The BJP is projected to retain the panchayat this time..." },
            { name: "Enmakaje", district: "Kasargod", type: "Grama Panchayat", team: "Team 3", date: "5 December", seatCall: "", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Meenja", district: "Kasargod", type: "Grama Panchayat", team: "Team 3", date: "4 December", seatCall: "Deadheat", bjpSeats: "8", ldfSeats: "1", udfSeats: "8", others: "", reasoning: "The BJP is experiencing a strong, high-visibility campaign..." },
            { name: "Paivalike", district: "Kasargod", type: "Grama Panchayat", team: "Team 3", date: "4 December", seatCall: "Deadheat", bjpSeats: "9", ldfSeats: "2", udfSeats: "9", others: "", reasoning: "The election features a direct fight between the BJP and LDF..." },
            { name: "Vorkady", district: "Kasargod", type: "Grama Panchayat", team: "Team 3", date: "4 December", seatCall: "Deadheat", bjpSeats: "9", ldfSeats: "0", udfSeats: "10", others: "", reasoning: "The BJP is set to retain all its current wards..." },
            { name: "Dharmadom", district: "Kannur", type: "Grama Panchayat", team: "Team 3", date: "2 December", seatCall: "BJP Behind", bjpSeats: "3", ldfSeats: "15", udfSeats: "1", others: "1", reasoning: "The LDF is expected to maintain control..." },
            { name: "Thalassery", district: "Kannur", type: "Municipality", team: "Team 3", date: "2 December", seatCall: "BJP Behind", bjpSeats: "10", ldfSeats: "37", udfSeats: "6", others: "1", reasoning: "The LDF will likely retain control of the municipality..." },
            { name: "Kollengode", district: "Palakkad", type: "Grama Panchayat", team: "Team 7", date: "2 December", seatCall: "", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Parli", district: "Palakkad", type: "Grama Panchayat", team: "Team 7", date: "3 December", seatCall: "BJP Ahead", bjpSeats: "13 - 16", ldfSeats: "5 - 7", udfSeats: "1 - 2", others: "", reasoning: "There is strong anti-incumbency in the GP..." },
            { name: "Akathethara", district: "Palakkad", type: "Grama Panchayat", team: "Team 7", date: "4 December", seatCall: "BJP Ahead", bjpSeats: "10", ldfSeats: "7-9", udfSeats: "1-2", others: "", reasoning: "There is strong public sentiment that the BJP will win..." },
            { name: "Malampuzha", district: "Palakkad", type: "Grama Panchayat", team: "Team 7", date: "4 December", seatCall: "Deadheat", bjpSeats: "5-7", ldfSeats: "5-7", udfSeats: "2-4", others: "", reasoning: "No front is likely to have a majority..." },
            { name: "Mundur", district: "Palakkad", type: "Grama Panchayat", team: "Team 7", date: "3 December", seatCall: "BJP Behind", bjpSeats: "5 - 6", ldfSeats: "11", udfSeats: "2", others: "", reasoning: "The CPI(M) is expected to lose around 2 wards but still retain..." },
            { name: "Palakkad", district: "Palakkad", type: "Municipality", team: "Team 7", date: "2 December", seatCall: "", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Elappully", district: "Palakkad", type: "Grama Panchayat", team: "Team 7", date: "4 December", seatCall: "BJP Behind", bjpSeats: "6-8", ldfSeats: "10-12", udfSeats: "3-4", others: "", reasoning: "The public sees the LDF as likely to win..." },
            { name: "Ottappalam", district: "Palakkad", type: "Municipality", team: "Team 7", date: "2 December", seatCall: "BJP Behind", bjpSeats: "10", ldfSeats: "16", udfSeats: "10", others: "", reasoning: "There is no major anti-incumbency against the municipality..." },
            { name: "Ambalapara", district: "Palakkad", type: "Grama Panchayat", team: "Team 7", date: "4 December", seatCall: "BJP Behind", bjpSeats: "5-7", ldfSeats: "12-13", udfSeats: "2-3", others: "2-4", reasoning: "Two independent groups are expected to damage the INC's prospects..." },
            { name: "Shornur", district: "Palakkad", type: "Municipality", team: "Team 7", date: "2 December", seatCall: "Deadheat", bjpSeats: "13 - 15", ldfSeats: "15 - 20", udfSeats: "4 - 7", others: "", reasoning: "There is strong anti-incumbency against the Shornur municipality..." },
            { name: "Vaniyamkulam", district: "Palakkad", type: "Grama Panchayat", team: "Team 7", date: "2 December", seatCall: "Deadheat", bjpSeats: "8 - 11", ldfSeats: "8 - 11", udfSeats: "0 - 2", others: "", reasoning: "Vaniyamkulam Panchayat is currently ruled by CPI(M)..." },
            { name: "Thiruvilwamala", district: "Thrissur", type: "Grama Panchayat", team: "Team 12", date: "2 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is working with the goal of winning 12 out of 19 wards..." },
            { name: "Guruvayoor", district: "Thrissur", type: "Municipality", team: "Team 12", date: "2 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is expected to make significant gains..." },
            { name: "Chowannur", district: "Thrissur", type: "Grama Panchayat", team: "Team 12", date: "4 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Chowannur is expected to remain largely unchanged..." },
            { name: "Kunnamakulam", district: "Thrissur", type: "Municipality", team: "Team 12", date: "4 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Kunnamkulam is witnessing a strong triangular contest..." },
            { name: "Cherpu", district: "Thrissur", type: "Grama Panchayat", team: "Team 11", date: "4 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Elavally", district: "Thrissur", type: "Grama Panchayat", team: "Team 11", date: "4 December", seatCall: "Deadheat", bjpSeats: "5 - 6", ldfSeats: "10", udfSeats: "2 - 3", others: "0", reasoning: "In Elavally Panchayat, the contest is shaping into a triangular fight..." },
            { name: "Vadanappilly", district: "Thrissur", type: "Grama Panchayat", team: "Team 11", date: "4 December", seatCall: "Deadheat", bjpSeats: "5 - 8", ldfSeats: "10 - 11", udfSeats: "1", others: "2 - 3", reasoning: "In Vadanappally Panchayat, the core contest is between the LDF and the BJP..." },
            { name: "Nattika", district: "Thrissur", type: "Grama Panchayat", team: "Team 11", date: "5 December", seatCall: "Deadheat", bjpSeats: "3 -5", ldfSeats: "56", udfSeats: "34", others: "-", reasoning: "In Nattika Panchayat, the BJP is expected to improve its position..." },
            { name: "Valappad", district: "Thrissur", type: "Grama Panchayat", team: "Team 11", date: "5 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Thrissur", district: "Thrissur", type: "Corporation", team: "Team 11", date: "2 December", seatCall: "BJP Behind", bjpSeats: "8-12", ldfSeats: "", udfSeats: "", others: "", reasoning: "Thrissur Corporation is a major centre of Christian institutional influence..." },
            { name: "Velookkara", district: "Thrissur", type: "Grama Panchayat", team: "Team 12", date: "3 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Velookkara Panchayat shows strong upward momentum for the BJP..." },
            { name: "Edavilangu", district: "Thrissur", type: "Grama Panchayat", team: "Team 12", date: "4 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Edavilangu panchayat continues to witness a direct contest..." },
            { name: "Sree Narayanapuram", district: "Thrissur", type: "Grama Panchayat", team: "Team 12", date: "4 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Sreenarayanapuram, a coastal panchayat traditionally leaning Left..." },
            { name: "Kodungallur", district: "Thrissur", type: "Municipality", team: "Team 12", date: "5 December", seatCall: "", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Chirakkadavu", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "4 December", seatCall: "BJP Behind", bjpSeats: "6-8", ldfSeats: "10-15", udfSeats: "2-4", others: "", reasoning: "Chirakkadavu Panchayat is moderately favourable for the BJP..." },
            { name: "Poonjar", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "3 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "BJP has a notable vote base in Poonjar..." },
            { name: "Poonjar Thekkekkara", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "4 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Poonjar Thekkekkara began booth-level work early..." },
            { name: "Nedumkunnam", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "4 December", seatCall: "BJP Behind", bjpSeats: "1", ldfSeats: "", udfSeats: "", others: "", reasoning: "The demographics of the Panchayat are unfavourable..." },
            { name: "Karukachal", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "4 December", seatCall: "BJP Behind", bjpSeats: "1-3", ldfSeats: "9-11", udfSeats: "3-5", others: "0-2", reasoning: "The BJP currently has one member in the Panchayat..." },
            { name: "Thidanadu", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "3 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "BJP has rapidly strengthened its base in Thidanad..." },
            { name: "Meenachil", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "2 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "In Meenachil Grama Panchayat, the BJP's campaign is weak..." },
            { name: "Kidangoor", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "2 December", seatCall: "BJP Ahead", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "BJP is running a strong campaign in Kidangoor..." },
            { name: "Aymanam", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "2 December", seatCall: "Deadheat", bjpSeats: "8-11", ldfSeats: "8-10", udfSeats: "2", others: "0", reasoning: "The party currently has 7 seats in this Panchayat..." },
            { name: "Mutholy", district: "Kottayam", type: "Grama Panchayat", team: "Team 6", date: "2 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "In Mutholi Grama Panchayat, the BJP is facing tough competition..." },
            { name: "Vaikom", district: "Kottayam", type: "Municipality", team: "Team 6", date: "2 December", seatCall: "BJP Behind", bjpSeats: "1", ldfSeats: "", udfSeats: "", others: "", reasoning: "The RSS had targeted 9 wards as very winnable..." },
            { name: "Tripunithura", district: "Ernakulam", type: "Municipality", team: "Team 1", date: "5 December", seatCall: "", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Vattavada", district: "Idukki", type: "Grama Panchayat", team: "Team 6", date: "5 December", seatCall: "", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Ala", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "2 December", seatCall: "BJP Ahead", bjpSeats: "8", ldfSeats: "5", udfSeats: "1", others: "", reasoning: "The BJP is ahead because of exceptional organizational coordination..." },
            { name: "Mulakkuzha", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "2 December", seatCall: "BJP Behind", bjpSeats: "6", ldfSeats: "11", udfSeats: "2", others: "", reasoning: "The BJP faces a tough uphill battle in Mulakuzha..." },
            { name: "Pandanad", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "2 December", seatCall: "BJP Ahead", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is positioned to win in Pandanad..." },
            { name: "Thiruvanvandoor", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "2 December", seatCall: "BJP Ahead", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP has secured a dominant position..." },
            { name: "Venmony", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "3 December", seatCall: "BJP Ahead", bjpSeats: "8", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is positioned to win 8 seats..." },
            { name: "Chettikulangara", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "4 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP aims to secure 8-9 wards..." },
            { name: "Krishnapuram", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "4 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP aims to increase its tally from 4 seats..." },
            { name: "Devikulangara", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "4 December", seatCall: "BJP Behind", bjpSeats: "6 - 7", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP aims to secure 6-7 wards..." },
            { name: "Pathiyoor", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "4 December", seatCall: "BJP Behind", bjpSeats: "9", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP aims to win upto 9 wards..." },
            { name: "Budhannur", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "3 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP's biggest advantage here comes from the CPM's internal rebellion..." },
            { name: "Chennithala -Thripperuthura", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "3 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is aiming to win the Panchayat this time..." },
            { name: "Puliyur", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "2 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is in a strong position by leading in 6 out of 8 target wards..." },
            { name: "Mavelikkara -Thamarakkulam", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "3 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is capitalising on the collapse of the LDF..." },
            { name: "Thazhakkara", district: "Alappuzha", type: "Grama Panchayat", team: "Team 2", date: "3 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is ambitious in this election..." },
            { name: "Earathu", district: "Pathanamthitta", type: "Grama Panchayat", team: "Team 8", date: "3 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Out of total 17 seats 11 seats are witnessing triangular contest..." },
            { name: "Naranganam", district: "Pathanamthitta", type: "Grama Panchayat", team: "Team 8", date: "2 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Naranganam panchayath is witnessing a triangular fight..." },
            { name: "Malayalapuzha", district: "Pathanamthitta", type: "Grama Panchayat", team: "Team 8", date: "2 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Malayalappuzha is witnessing fight between LDF and BJP..." },
            { name: "Kalanjoor", district: "Pathanamthitta", type: "Grama Panchayat", team: "Team 8", date: "3 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is targeting 11 seats in Kalanjoor..." },
            { name: "Pandalam", district: "Pathanamthitta", type: "Municipality", team: "Team 8", date: "3 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "The BJP is in a dead heat despite favorable demographics..." },
            { name: "Panthalam-Thekkekkara", district: "Pathanamthitta", type: "Grama Panchayat", team: "Team 8", date: "3 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "With a target of 10 out of 15 seats, the BJP has a strong chance..." },
            { name: "Kulanada", district: "Pathanamthitta", type: "Grama Panchayat", team: "Team 8", date: "3 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "BJP, currently holding 8 seats in Kulanada Panchayath..." },
            { name: "Omalloor", district: "Pathanamthitta", type: "Grama Panchayat", team: "Team 8", date: "2 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Omalloor is witnessing a triangular fight with LDF has an edge..." },
            { name: "Ranny Perunadu", district: "Pathanamthitta", type: "Grama Panchayat", team: "Team 8", date: "4 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Among the 15 seats BJP is aiming to capture power..." },
            { name: "Mylom", district: "Kollam", type: "Grama Panchayat", team: "Team 4", date: "3 December", seatCall: "BJP Ahead", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Mylom Grama Panchayat has strong BJP potential..." },
            { name: "Ummannoor", district: "Kollam", type: "Grama Panchayat", team: "Team 4", date: "3 December", seatCall: "BJP Behind", bjpSeats: "4", ldfSeats: "12", udfSeats: "4", others: "2", reasoning: "Ummannoor Grama Panchayat remains a strong LDF bastion..." },
            { name: "Kunnathur", district: "Kollam", type: "Grama Panchayat", team: "Team 4", date: "4 December", seatCall: "BJP Behind", bjpSeats: "5", ldfSeats: "9", udfSeats: "2", others: "1", reasoning: "Kunnathur Panchayat is poised to remain under LDF influence..." },
            { name: "Pavithreswaram", district: "Kollam", type: "Grama Panchayat", team: "Team 4", date: "4 December", seatCall: "BJP Behind", bjpSeats: "5", ldfSeats: "14", udfSeats: "2", others: "1", reasoning: "Pavithreshwaram Panchayat is strongly positioned to remain with the LDF..." },
            { name: "Poruvazhi", district: "Kollam", type: "Grama Panchayat", team: "Team 4", date: "4 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "BJP currently holds five wards in Poruvazhy..." },
            { name: "Kareepra", district: "Kollam", type: "Grama Panchayat", team: "Team 4", date: "3 December", seatCall: "BJP Behind", bjpSeats: "7", ldfSeats: "10", udfSeats: "1", others: "1", reasoning: "Kareepra Panchayat shows a significantly favourable landscape..." },
            { name: "Neduvathur", district: "Kollam", type: "Grama Panchayat", team: "Team 4", date: "3 December", seatCall: "BJP Ahead", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Neduvathur Grama Panchayat has 19 seats..." },
            { name: "Chathannur", district: "Kollam", type: "Grama Panchayat", team: "Team 5", date: "3 December", seatCall: "BJP Behind", bjpSeats: "4-6", ldfSeats: "6-8", udfSeats: "5-6", others: "0-1", reasoning: "BJP is slightly trailing overall..." },
            { name: "Adichanaloor", district: "Kollam", type: "Grama Panchayat", team: "Team 5", date: "3 December", seatCall: "Deadheat", bjpSeats: "8-10", ldfSeats: "8-10", udfSeats: "4-5", others: "0-1", reasoning: "BJP is in a dead heat with the LDF..." },
            { name: "Chirakkara", district: "Kollam", type: "Grama Panchayat", team: "Team 5", date: "2 December", seatCall: "BJP Behind", bjpSeats: "5-6", ldfSeats: "6-7", udfSeats: "4-5", others: "0-1", reasoning: "The BJP remains behind overall due to a weak organisational structure..." },
            { name: "Kollam", district: "Kollam", type: "Corporation", team: "Team 4", date: "2 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Post-delimitation, the 56 wards of Kollam Corporation..." },
            { name: "Elampalloor", district: "Kollam", type: "Grama Panchayat", team: "Team 5", date: "4 December", seatCall: "", bjpSeats: "7-8", ldfSeats: "7-8", udfSeats: "4-5", others: "", reasoning: "" },
            { name: "Perinad", district: "Kollam", type: "Grama Panchayat", team: "Team 5", date: "4 December", seatCall: "", bjpSeats: "8-9", ldfSeats: "8-9", udfSeats: "3-4", others: "", reasoning: "" },
            { name: "Kalluvathukkal", district: "Kollam", type: "Grama Panchayat", team: "Team 5", date: "3 December", seatCall: "BJP Behind", bjpSeats: "6-7", ldfSeats: "9-10", udfSeats: "2-3", others: "1-2", reasoning: "BJP has stepped up its activities compared to 2023..." },
            { name: "Poothakulam", district: "Kollam", type: "Grama Panchayat", team: "Team 5", date: "2 December", seatCall: "BJP Behind", bjpSeats: "6-7", ldfSeats: "8-10", udfSeats: "3-4", others: "0-1", reasoning: "Although this panchayat was a targeted one..." },
            { name: "Paravoor", district: "Kollam", type: "Municipality", team: "Team 5", date: "2 December", seatCall: "BJP Behind", bjpSeats: "7-8", ldfSeats: "17-18", udfSeats: "4-5", others: "1-2", reasoning: "The BJP remains behind overall due to strong Muslim consolidation..." },
            { name: "Attingal", district: "Trivandrum", type: "Municipality", team: "Team 9", date: "2 December", seatCall: "Deadheat", bjpSeats: "10-12", ldfSeats: "20-22", udfSeats: "4-5", others: "N/A", reasoning: "Attingal is likely to remain with the LDF..." },
            { name: "Ottoor", district: "Trivandrum", type: "Grama Panchayat", team: "Team 9", date: "2 December", seatCall: "BJP Ahead", bjpSeats: "7", ldfSeats: "4", udfSeats: "3", others: "3", reasoning: "Ottur has 13 seats, with BJP currently holding 3..." },
            { name: "Vakkom", district: "Trivandrum", type: "Grama Panchayat", team: "Team 9", date: "2 December", seatCall: "Deadheat", bjpSeats: "5 - 7", ldfSeats: "3", udfSeats: "3", others: "1", reasoning: "The UDF is currently in power, but the incumbent is facing serious allegations..." },
            { name: "Mudakkal", district: "Trivandrum", type: "Grama Panchayat", team: "Team 9", date: "2 December", seatCall: "Deadheat", bjpSeats: "4 - 6", ldfSeats: "10", udfSeats: "5- 6", others: "0", reasoning: "In Mudakkal, there is a tight fight between LDF and BJP..." },
            { name: "Pulimath", district: "Trivandrum", type: "Grama Panchayat", team: "Team 9", date: "4 December", seatCall: "BJP Behind", bjpSeats: "2 -3", ldfSeats: "9 - 10", udfSeats: "7 - 9", others: "1", reasoning: "In Pulimath, BJP is facing organisational issues..." },
            { name: "Kilimanoor", district: "Trivandrum", type: "Grama Panchayat", team: "Team 9", date: "4 December", seatCall: "BJP Behind", bjpSeats: "1- 3", ldfSeats: "8 to 9", udfSeats: "4 - 6", others: "0", reasoning: "Kilimanoor has no major fight; it is a strong LDF area..." },
            { name: "Nedumangad", district: "Trivandrum", type: "Municipality", team: "Team 9", date: "3 December", seatCall: "BJP Behind", bjpSeats: "8 to 12", ldfSeats: "15to 17", udfSeats: "9 to 10", others: "1", reasoning: "There is a tight competition between the LDF and BJP..." },
            { name: "Pothencode", district: "Trivandrum", type: "Grama Panchayat", team: "Team 9", date: "3 December", seatCall: "BJP Behind", bjpSeats: "6 to 7", ldfSeats: "9 to 10", udfSeats: "2 to 3", others: "", reasoning: "BJP currently has 4 seats, all of which have a high chance of being retained..." },
            { name: "Kallara", district: "Trivandrum", type: "Grama Panchayat", team: "Team 9", date: "4 December", seatCall: "BJP Behind", bjpSeats: "1 - 3", ldfSeats: "5 - 8", udfSeats: "6 -12", others: "0", reasoning: "Kallara is a strong UDF area..." },
            { name: "Vamanapuram", district: "Trivandrum", type: "Grama Panchayat", team: "Team 9", date: "4 December", seatCall: "BJP Behind", bjpSeats: "2 - 3", ldfSeats: "5 - 8", udfSeats: "5 - 7", others: "N/A", reasoning: "In this area, visible anti-incumbency against the current LDF..." },
            { name: "Thiruvananthapuram", district: "Trivandrum", type: "Corporation", team: "", date: "", seatCall: "", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "" },
            { name: "Vellanad", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "2 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Field data shows big expectations (912 seats)..." },
            { name: "Balaramapuram", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "4 December", seatCall: "Deadheat", bjpSeats: "7 - 8", ldfSeats: "8 - 10", udfSeats: "4 - 5", others: "0 - 2", reasoning: "LDF is currently positioned strongest in the panchayat..." },
            { name: "Kottukal", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "4 December", seatCall: "BJP Behind", bjpSeats: "3 - 4", ldfSeats: "7 - 8", udfSeats: "10", others: "0 - 2", reasoning: "Current assessments indicate a slight edge for the UDF..." },
            { name: "Maranallur", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "4 December", seatCall: "Deadheat", bjpSeats: "8 - 9", ldfSeats: "8 - 9", udfSeats: "4 - 5", others: "0", reasoning: "The panchayat's voter profile comprises roughly 50% Nadars..." },
            { name: "Vilappil", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "2 December", seatCall: "Deadheat", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Several multi-corner fights..." },
            { name: "Malayinkeezhu", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "2 December", seatCall: "BJP Behind", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Malayinkeezhu has a large Nair majority..." },
            { name: "Pallichal", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "4 December", seatCall: "BJP Behind", bjpSeats: "2", ldfSeats: "10 - 12", udfSeats: "8", others: "0", reasoning: "BJP's decline from previous strength reflects dissatisfaction..." },
            { name: "Vilavoorkal", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "2 December", seatCall: "BJP Ahead", bjpSeats: "", ldfSeats: "", udfSeats: "", others: "", reasoning: "Vilavoorkal has strong structural conditions favouring BJP..." },
            { name: "Kollayil", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "3 December", seatCall: "BJP Behind", bjpSeats: "4-5", ldfSeats: "7-8", udfSeats: "5", others: "", reasoning: "Local dynamics present a challenge..." },
            { name: "Perumkadavila", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "3 December", seatCall: "Deadheat", bjpSeats: "6-7", ldfSeats: "6", udfSeats: "4", others: "", reasoning: "While there is significant optimism regarding Aruvippuram..." },
            { name: "Aryankode", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "3 December", seatCall: "BJP Behind", bjpSeats: "2-4", ldfSeats: "8-9", udfSeats: "4", others: "", reasoning: "Three wards are structurally weak..." },
            { name: "Kallikkadu", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "3 December", seatCall: "BJP Ahead", bjpSeats: "7-8", ldfSeats: "3", udfSeats: "3", others: "", reasoning: "A positive shift in voter sentiment is evident..." },
            { name: "Ottasekaramangalam", district: "Trivandrum", type: "Grama Panchayat", team: "Team 10", date: "3 December", seatCall: "BJP Behind", bjpSeats: "3-4", ldfSeats: "", udfSeats: "", others: "", reasoning: "Structural hurdles in regaining lost ground..." }
        ];

        // --- GLOBAL VARIABLES ---
        let filteredData = [...rawData];
        let filteredPIData = [];
        let comparisonData = [];
        let activeTab = 'dheeraj';
        let districtChartInstance = null;
        let confidenceChartInstance = null;
        let piDistrictChartInstance = null;
        let piSeatCallChartInstance = null;

        // --- TAB SWITCHING ---
        function switchTab(tab) {
            activeTab = tab;
            
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`tab-${tab}`).classList.add('active');
            
            // Update content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`content-${tab}`).classList.add('active');
            
            // Initialize tab-specific data
            if (tab === 'pi-team' && filteredPIData.length === 0) {
                filteredPIData = piTeamData.filter(item => item.seatCall); // Only show analyzed ones
                populatePIDistricts();
                updatePIStats();
                renderPIGrid();
                initPICharts();
            } else if (tab === 'comparison' && comparisonData.length === 0) {
                buildComparisonData();
                populateComparisonDistricts();
                updateComparisonStats();
                renderComparisonGrid();
                initComparisonCharts();
            } else if (tab === 'comparison' && comparisonData.length > 0) {
                // Re-render charts if data already exists
                initComparisonCharts();
            }
            
            lucide.createIcons();
        }
        
        // --- PI TEAM FUNCTIONS ---
        function populatePIDistricts() {
            const districts = [...new Set(piTeamData.filter(i => i.seatCall).map(item => item.district))].sort();
            const select = document.getElementById('piDistrictFilter');
            select.innerHTML = '<option value="All">All Districts</option>';
            districts.forEach(d => {
                const option = document.createElement('option');
                option.value = d;
                option.textContent = d;
                select.appendChild(option);
            });
        }
        
        function updatePIStats() {
            const dataToShow = piTeamData.filter(i => i.seatCall);
            document.getElementById('pi-total-count').innerText = dataToShow.length;
            
            const aheadCount = dataToShow.filter(i => i.seatCall === 'BJP Ahead').length;
            const deadheatCount = dataToShow.filter(i => i.seatCall === 'Deadheat').length;
            const behindCount = dataToShow.filter(i => i.seatCall === 'BJP Behind').length;
            
            document.getElementById('pi-ahead-count').innerText = aheadCount;
            document.getElementById('pi-deadheat-count').innerText = deadheatCount;
            document.getElementById('pi-behind-count').innerText = behindCount;
        }
        
        function renderPIGrid() {
            const container = document.getElementById('piGridContainer');
            container.innerHTML = '';
            
            filteredPIData.forEach(item => {
                if (!item.seatCall) return;
                
                let borderColor = 'border-gray-700';
                let glowClass = '';
                let titleColor = 'text-white';
                let statusClass = '';
                let statusText = item.seatCall;
                
                if (item.seatCall === 'BJP Ahead') {
                    borderColor = 'border-cyber-high';
                    glowClass = 'shadow-[0_0_15px_rgba(57,255,20,0.15)]';
                    titleColor = 'text-white neon-text-green';
                    statusClass = 'text-cyber-high font-bold';
                } else if (item.seatCall === 'BJP Behind') {
                    borderColor = 'border-cyber-tight';
                    glowClass = 'shadow-[0_0_15px_rgba(255,119,0,0.15)]';
                    titleColor = 'text-white neon-text-orange';
                    statusClass = 'text-cyber-tight font-bold';
                } else {
                    borderColor = 'border-cyber-medium';
                    glowClass = 'shadow-[0_0_15px_rgba(252,238,10,0.15)]';
                    titleColor = 'text-white neon-text-yellow';
                    statusClass = 'text-cyber-medium font-bold';
                }
                
                const card = document.createElement('div');
                card.className = `glass-panel rounded-lg p-5 border ${borderColor} ${glowClass} hover:scale-[1.02] transition-transform duration-300`;
                
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <span class="text-xs text-cyber-primary font-bold tracking-widest uppercase mb-1 block">${item.district}</span>
                            <h3 class="text-xl font-headers ${titleColor}">${item.name}</h3>
                            <span class="text-xs text-gray-500 uppercase">${item.type}</span>
                        </div>
                        <div class="bg-gray-800/50 p-2 rounded text-center min-w-[60px] border border-gray-700">
                            <div class="text-[10px] text-gray-400">TEAM</div>
                            <div class="text-sm font-bold text-white">${item.team}</div>
                        </div>
                    </div>
                    
                    <div class="space-y-3 mb-4">
                        <div class="flex items-center gap-2 text-sm text-gray-300">
                            <i data-lucide="target" class="w-4 h-4 text-cyber-primary"></i>
                            <span>Seat Call: <span class="${statusClass}">${statusText}</span></span>
                        </div>
                        ${item.bjpSeats ? `
                        <div class="grid grid-cols-3 gap-2 text-xs">
                            <div class="bg-cyber-high/10 p-2 rounded border border-cyber-high/30">
                                <div class="text-cyber-high font-bold mb-1">BJP</div>
                                <div class="text-white font-bold">${item.bjpSeats}</div>
                            </div>
                            <div class="bg-red-500/10 p-2 rounded border border-red-500/30">
                                <div class="text-red-400 font-bold mb-1">LDF</div>
                                <div class="text-white font-bold">${item.ldfSeats || '-'}</div>
                            </div>
                            <div class="bg-blue-500/10 p-2 rounded border border-blue-500/30">
                                <div class="text-blue-400 font-bold mb-1">UDF</div>
                                <div class="text-white font-bold">${item.udfSeats || '-'}</div>
                            </div>
                        </div>` : ''}
                        <div class="flex items-center gap-2 text-sm text-gray-300">
                            <i data-lucide="calendar" class="w-4 h-4 text-cyber-primary"></i>
                            <span>Analyzed: ${item.date}</span>
                        </div>
                    </div>
                    
                    ${item.reasoning ? `
                    <div class="border-t border-gray-700 pt-3">
                        <p class="text-sm text-gray-400 italic leading-relaxed line-clamp-3">"${item.reasoning.substring(0, 200)}${item.reasoning.length > 200 ? '...' : ''}"</p>
                    </div>` : ''}
                `;
                container.appendChild(card);
            });
            
            lucide.createIcons();
        }
        
        function initPICharts() {
            const ctx1 = document.getElementById('piDistrictChart').getContext('2d');
            const ctx2 = document.getElementById('piSeatCallChart').getContext('2d');
            
            piDistrictChartInstance = new Chart(ctx1, {
                type: 'bar',
                data: getPIDistrictData(),
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { boxWidth: 10, usePointStyle: true } }
                    },
                    scales: {
                        y: { stacked: true, beginAtZero: true, grid: { color: 'rgba(255,255,255,0.05)' } },
                        x: { stacked: true, grid: { display: false } }
                    }
                }
            });
            
            piSeatCallChartInstance = new Chart(ctx2, {
                type: 'doughnut',
                data: getPISeatCallData(),
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: { position: 'right', labels: { boxWidth: 10, usePointStyle: true } }
                    }
                }
            });
        }
        
        function getPIDistrictData() {
            const agg = {};
            filteredPIData.forEach(item => {
                if (!item.seatCall) return;
                if (!agg[item.district]) agg[item.district] = { Ahead: 0, Deadheat: 0, Behind: 0 };
                if (item.seatCall === 'BJP Ahead') agg[item.district].Ahead++;
                else if (item.seatCall === 'Deadheat') agg[item.district].Deadheat++;
                else if (item.seatCall === 'BJP Behind') agg[item.district].Behind++;
            });
            
            const sortedLabels = Object.keys(agg).sort((a,b) => {
                const totalA = agg[a].Ahead + agg[a].Deadheat + agg[a].Behind;
                const totalB = agg[b].Ahead + agg[b].Deadheat + agg[b].Behind;
                return totalB - totalA;
            }).slice(0, 10);
            
            return {
                labels: sortedLabels,
                datasets: [
                    { label: 'Ahead', data: sortedLabels.map(l => agg[l].Ahead), backgroundColor: '#39ff14', barPercentage: 0.6 },
                    { label: 'Deadheat', data: sortedLabels.map(l => agg[l].Deadheat), backgroundColor: '#fcee0a', barPercentage: 0.6 },
                    { label: 'Behind', data: sortedLabels.map(l => agg[l].Behind), backgroundColor: '#ff7700', barPercentage: 0.6 }
                ]
            };
        }
        
        function getPISeatCallData() {
            const ahead = filteredPIData.filter(i => i.seatCall === 'BJP Ahead').length;
            const deadheat = filteredPIData.filter(i => i.seatCall === 'Deadheat').length;
            const behind = filteredPIData.filter(i => i.seatCall === 'BJP Behind').length;
            
            return {
                labels: ['BJP Ahead', 'Deadheat', 'BJP Behind'],
                datasets: [{
                    data: [ahead, deadheat, behind],
                    backgroundColor: ['#39ff14', '#fcee0a', '#ff7700'],
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            };
        }
        
        // --- COMPARISON CHART FUNCTIONS ---
        let sourceCoverageChartInstance, confidenceComparisonChartInstance, districtCoverageChartInstance;
        
        function initComparisonCharts() {
            // Destroy existing charts if they exist
            if (sourceCoverageChartInstance) sourceCoverageChartInstance.destroy();
            if (confidenceComparisonChartInstance) confidenceComparisonChartInstance.destroy();
            if (districtCoverageChartInstance) districtCoverageChartInstance.destroy();
            
            const ctx1 = document.getElementById('sourceCoverageChart').getContext('2d');
            const ctx2 = document.getElementById('confidenceComparisonChart').getContext('2d');
            const ctx3 = document.getElementById('districtCoverageChart').getContext('2d');
            
            // Source Coverage Chart
            sourceCoverageChartInstance = new Chart(ctx1, {
                type: 'doughnut',
                data: getSourceCoverageData(),
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: { position: 'bottom', labels: { boxWidth: 12, usePointStyle: true, color: '#e0e0e0' } }
                    }
                }
            });
            
            // Confidence Comparison Chart
            confidenceComparisonChartInstance = new Chart(ctx2, {
                type: 'bar',
                data: getConfidenceComparisonData(),
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { boxWidth: 12, usePointStyle: true, color: '#e0e0e0' } }
                    },
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8585a3' } },
                        x: { grid: { display: false }, ticks: { color: '#8585a3' } }
                    }
                }
            });
            
            // District Coverage Comparison Chart
            districtCoverageChartInstance = new Chart(ctx3, {
                type: 'bar',
                data: getDistrictCoverageData(),
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { boxWidth: 12, usePointStyle: true, color: '#e0e0e0' } }
                    },
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#8585a3' } },
                        x: { grid: { display: false }, ticks: { color: '#8585a3', maxRotation: 45, minRotation: 45 } }
                    }
                }
            });
        }
        
        function getSourceCoverageData() {
            const bothCount = comparisonData.filter(d => d.dheeraj && d.piTeam).length;
            const dheerajOnly = comparisonData.filter(d => d.dheeraj && !d.piTeam).length;
            const piOnly = comparisonData.filter(d => !d.dheeraj && d.piTeam).length;
            
            return {
                labels: ['Both Sources', 'Dheeraj Only', 'PI Team Only'],
                datasets: [{
                    data: [bothCount, dheerajOnly, piOnly],
                    backgroundColor: ['#39ff14', '#fcee0a', '#ff7700'],
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            };
        }
        
        function getConfidenceComparisonData() {
            // Dheeraj confidence levels
            const dheerajHigh = rawData.filter(i => i.prob === 'High').length;
            const dheerajMed = rawData.filter(i => i.prob === 'Medium').length;
            const dheerajTight = rawData.filter(i => i.prob === 'Tight').length;
            
            // PI Team seat calls
            const piAhead = piTeamData.filter(i => i.seatCall === 'BJP Ahead').length;
            const piDeadheat = piTeamData.filter(i => i.seatCall === 'Deadheat').length;
            const piBehind = piTeamData.filter(i => i.seatCall === 'BJP Behind').length;
            
            return {
                labels: ['High/Ahead', 'Medium/Deadheat', 'Tight/Behind'],
                datasets: [
                    {
                        label: 'Dheeraj Analysis',
                        data: [dheerajHigh, dheerajMed, dheerajTight],
                        backgroundColor: '#00f0ff',
                        barPercentage: 0.7
                    },
                    {
                        label: 'PI Team Analysis',
                        data: [piAhead, piDeadheat, piBehind],
                        backgroundColor: '#39ff14',
                        barPercentage: 0.7
                    }
                ]
            };
        }
        
        function getDistrictCoverageData() {
            // Get all districts from both sources
            const allDistricts = new Set();
            rawData.forEach(d => allDistricts.add(d.district));
            piTeamData.forEach(d => allDistricts.add(d.district));
            
            const districts = Array.from(allDistricts).sort();
            
            const dheerajCounts = districts.map(dist => rawData.filter(d => d.district === dist).length);
            const piCounts = districts.map(dist => piTeamData.filter(d => d.district === dist).length);
            
            // Only show top 10 districts by total coverage
            const districtTotals = districts.map((dist, idx) => ({
                name: dist,
                dheerajCount: dheerajCounts[idx],
                piCount: piCounts[idx],
                total: dheerajCounts[idx] + piCounts[idx]
            })).sort((a, b) => b.total - a.total).slice(0, 10);
            
            return {
                labels: districtTotals.map(d => d.name),
                datasets: [
                    {
                        label: 'Dheeraj Analysis',
                        data: districtTotals.map(d => d.dheerajCount),
                        backgroundColor: '#00f0ff',
                        barPercentage: 0.7
                    },
                    {
                        label: 'PI Team Analysis',
                        data: districtTotals.map(d => d.piCount),
                        backgroundColor: '#39ff14',
                        barPercentage: 0.7
                    }
                ]
            };
        }
        
        // --- COMPARISON FUNCTIONS ---
        function buildComparisonData() {
            comparisonData = [];
            const processedNames = new Set();
            
            // Add all Dheeraj data with matching PI Team data
            rawData.forEach(dheerajItem => {
                const piMatch = findBestMatch(dheerajItem.name, piTeamData);
                comparisonData.push({
                    name: dheerajItem.name,
                    district: dheerajItem.district,
                    type: dheerajItem.type,
                    dheeraj: dheerajItem,
                    piTeam: piMatch,
                    hasBoth: !!piMatch && !!piMatch.seatCall,
                    source: piMatch && piMatch.seatCall ? 'both' : 'dheeraj'
                });
                processedNames.add(dheerajItem.name.toLowerCase());
                if (piMatch) processedNames.add(piMatch.name.toLowerCase());
            });
            
            // Add PI Team data that wasn't matched
            piTeamData.forEach(piItem => {
                if (!piItem.seatCall) return;
                if (!processedNames.has(piItem.name.toLowerCase())) {
                    comparisonData.push({
                        name: piItem.name,
                        district: piItem.district,
                        type: piItem.type,
                        dheeraj: null,
                        piTeam: piItem,
                        hasBoth: false,
                        source: 'pi'
                    });
                }
            });
        }
        
        function populateComparisonDistricts() {
            const districts = [...new Set(comparisonData.map(item => item.district))].sort();
            const select = document.getElementById('compDistrictFilter');
            select.innerHTML = '<option value="All">All Districts</option>';
            districts.forEach(d => {
                const option = document.createElement('option');
                option.value = d;
                option.textContent = d;
                select.appendChild(option);
            });
        }
        
        function updateComparisonStats() {
            document.getElementById('comp-total').innerText = comparisonData.length;
            document.getElementById('comp-both').innerText = comparisonData.filter(i => i.hasBoth).length;
            document.getElementById('comp-dheeraj-only').innerText = comparisonData.filter(i => i.source === 'dheeraj').length;
            document.getElementById('comp-pi-only').innerText = comparisonData.filter(i => i.source === 'pi').length;
        }
        
        function renderComparisonGrid() {
            const container = document.getElementById('compGridContainer');
            container.innerHTML = '';
            
            comparisonData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'glass-panel rounded-lg p-6 border-l-4 border-cyber-primary hover:scale-[1.01] transition-transform duration-300';
                
                let sourceBadge = '';
                if (item.hasBoth) {
                    sourceBadge = '<span class="px-2 py-1 bg-cyber-high/20 text-cyber-high text-xs rounded font-bold">BOTH SOURCES</span>';
                } else if (item.source === 'dheeraj') {
                    sourceBadge = '<span class="px-2 py-1 bg-cyber-medium/20 text-cyber-medium text-xs rounded font-bold">DHEERAJ ONLY</span>';
                } else {
                    sourceBadge = '<span class="px-2 py-1 bg-cyber-tight/20 text-cyber-tight text-xs rounded font-bold">PI TEAM ONLY</span>';
                }
                
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-2xl font-headers text-white neon-text mb-1">${item.name}</h3>
                            <div class="flex gap-2 items-center">
                                <span class="text-sm text-cyber-primary">${item.district}  ${item.type}</span>
                                ${sourceBadge}
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid ${item.hasBoth ? 'md:grid-cols-2' : 'grid-cols-1'} gap-6">
                        ${item.dheeraj ? `
                        <div class="bg-cyber-dark/50 p-4 rounded border border-cyber-primary/30">
                            <h4 class="font-headers text-sm text-cyber-primary mb-3 tracking-widest">DHEERAJ ANALYSIS</h4>
                            <div class="space-y-2 text-sm">
                                <div><span class="text-gray-400">Probability:</span> <span class="font-bold ${
                                    item.dheeraj.prob === 'High' ? 'text-cyber-high' : 
                                    item.dheeraj.prob === 'Tight' ? 'text-cyber-tight' : 'text-cyber-medium'
                                }">${item.dheeraj.prob}</span></div>
                                <div><span class="text-gray-400">Demographics:</span> <span class="text-white">${item.dheeraj.h_dem}</span></div>
                                <div><span class="text-gray-400">LS Lead:</span> <span class="text-white">${item.dheeraj.ls_lead}</span></div>
                                <div class="pt-2 border-t border-gray-700">
                                    <p class="text-gray-300 italic text-xs leading-relaxed">"${item.dheeraj.note.substring(0, 150)}..."</p>
                                </div>
                            </div>
                        </div>
                        ` : '<div class="bg-gray-900/50 p-4 rounded border border-gray-700/30 flex items-center justify-center text-gray-500"><p>No Dheeraj Analysis Available</p></div>'}
                        
                        ${item.piTeam && item.piTeam.seatCall ? `
                        <div class="bg-cyber-dark/50 p-4 rounded border border-cyber-high/30">
                            <h4 class="font-headers text-sm text-cyber-high mb-3 tracking-widest">PI TEAM ANALYSIS</h4>
                            <div class="space-y-2 text-sm">
                                <div><span class="text-gray-400">Seat Call:</span> <span class="font-bold ${
                                    item.piTeam.seatCall === 'BJP Ahead' ? 'text-cyber-high' : 
                                    item.piTeam.seatCall === 'BJP Behind' ? 'text-cyber-tight' : 'text-cyber-medium'
                                }">${item.piTeam.seatCall}</span></div>
                                ${item.piTeam.bjpSeats ? `<div><span class="text-gray-400">BJP Seats:</span> <span class="text-white">${item.piTeam.bjpSeats}</span></div>` : ''}
                                ${item.piTeam.ldfSeats ? `<div><span class="text-gray-400">LDF Seats:</span> <span class="text-white">${item.piTeam.ldfSeats}</span></div>` : ''}
                                ${item.piTeam.udfSeats ? `<div><span class="text-gray-400">UDF Seats:</span> <span class="text-white">${item.piTeam.udfSeats}</span></div>` : ''}
                                <div><span class="text-gray-400">Team:</span> <span class="text-white">${item.piTeam.team}</span></div>
                                ${item.piTeam.reasoning ? `
                                <div class="pt-2 border-t border-gray-700">
                                    <p class="text-gray-300 italic text-xs leading-relaxed">"${item.piTeam.reasoning.substring(0, 150)}..."</p>
                                </div>` : ''}
                            </div>
                        </div>
                        ` : (item.hasBoth ? '<div class="bg-gray-900/50 p-4 rounded border border-gray-700/30 flex items-center justify-center text-gray-500"><p>No PI Team Analysis Available</p></div>' : '')}
                    </div>
                `;
                container.appendChild(card);
            });
            
            lucide.createIcons();
        }
        
        // --- PI TEAM FILTERS ---
        function handlePISearch() {
            const searchTerm = document.getElementById('piSearchInput').value.toLowerCase();
            const distFilter = document.getElementById('piDistrictFilter').value;
            const seatCallFilter = document.getElementById('piSeatCallFilter').value;
            
            filteredPIData = piTeamData.filter(item => {
                if (!item.seatCall) return false;
                const matchesSearch = item.name.toLowerCase().includes(searchTerm);
                const matchesDist = distFilter === 'All' || item.district === distFilter;
                const matchesSeatCall = seatCallFilter === 'All' || item.seatCall === seatCallFilter;
                return matchesSearch && matchesDist && matchesSeatCall;
            });
            
            updatePIStats();
            renderPIGrid();
            if (piDistrictChartInstance) {
                piDistrictChartInstance.data = getPIDistrictData();
                piDistrictChartInstance.update();
            }
            if (piSeatCallChartInstance) {
                piSeatCallChartInstance.data.datasets[0].data = getPISeatCallData().datasets[0].data;
                piSeatCallChartInstance.update();
            }
        }
        
        // --- COMPARISON FILTERS ---
        function handleCompSearch() {
            const searchTerm = document.getElementById('compSearchInput').value.toLowerCase();
            const distFilter = document.getElementById('compDistrictFilter').value;
            const viewFilter = document.getElementById('compViewFilter').value;
            
            let filtered = comparisonData.filter(item => {
                const matchesSearch = item.name.toLowerCase().includes(searchTerm);
                const matchesDist = distFilter === 'All' || item.district === distFilter;
                return matchesSearch && matchesDist;
            });
            
            if (viewFilter === 'Both') {
                filtered = filtered.filter(i => i.hasBoth);
            } else if (viewFilter === 'DheerajOnly') {
                filtered = filtered.filter(i => i.source === 'dheeraj');
            } else if (viewFilter === 'PIOnly') {
                filtered = filtered.filter(i => i.source === 'pi');
            }
            
            // Temporarily update comparisonData for rendering
            const original = comparisonData;
            comparisonData = filtered;
            renderComparisonGrid();
            comparisonData = original;
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            populateDistricts();
            updateStats();
            renderGrid();
            initCharts();
            
            // Event Listeners - Dheeraj Tab
            document.getElementById('searchInput').addEventListener('input', handleSearch);
            document.getElementById('districtFilter').addEventListener('change', handleFilter);
            document.getElementById('probFilter').addEventListener('change', handleFilter);
            
            // Event Listeners - PI Team Tab
            document.getElementById('piSearchInput').addEventListener('input', handlePISearch);
            document.getElementById('piDistrictFilter').addEventListener('change', handlePISearch);
            document.getElementById('piSeatCallFilter').addEventListener('change', handlePISearch);
            
            // Event Listeners - Comparison Tab
            document.getElementById('compSearchInput').addEventListener('input', handleCompSearch);
            document.getElementById('compDistrictFilter').addEventListener('change', handleCompSearch);
            document.getElementById('compViewFilter').addEventListener('change', handleCompSearch);
        });

        // --- LOGIC FUNCTIONS ---

        function populateDistricts() {
            const districts = [...new Set(rawData.map(item => item.district))].sort();
            const select = document.getElementById('districtFilter');
            districts.forEach(d => {
                const option = document.createElement('option');
                option.value = d;
                option.textContent = d;
                select.appendChild(option);
            });
        }

        function handleSearch(e) {
            filterData();
        }

        function handleFilter(e) {
            filterData();
        }

        function filterData() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const distFilter = document.getElementById('districtFilter').value;
            const probFilter = document.getElementById('probFilter').value;

            filteredData = rawData.filter(item => {
                const matchesSearch = item.name.toLowerCase().includes(searchTerm) || 
                                      item.note.toLowerCase().includes(searchTerm);
                const matchesDist = distFilter === 'All' || item.district === distFilter;
                
                let matchesProb = true;
                if (probFilter === 'High') matchesProb = item.prob === 'High';
                if (probFilter === 'Medium') matchesProb = item.prob === 'Medium';
                if (probFilter === 'Tight') matchesProb = item.prob === 'Tight';

                return matchesSearch && matchesDist && matchesProb;
            });

            updateStats();
            renderGrid();
            updateCharts();
        }

        function updateStats() {
            // Count total
            animateValue("total-count", parseInt(document.getElementById("total-count").innerText), filteredData.length, 500);

            // Count High
            const safeCount = filteredData.filter(i => i.prob === 'High').length;
            document.getElementById('safe-count').innerText = safeCount;

            // Count Medium
            const medCount = filteredData.filter(i => i.prob === 'Medium').length;
            document.getElementById('medium-count').innerText = medCount;

            // Count Tight
            const tightCount = filteredData.filter(i => i.prob === 'Tight').length;
            document.getElementById('tight-count').innerText = tightCount;
        }

        function renderGrid() {
            const container = document.getElementById('gridContainer');
            container.innerHTML = '';

            filteredData.forEach(item => {
                // Determine Colors based on Probability
                let borderColor = 'border-gray-700';
                let glowClass = '';
                let titleColor = 'text-white';
                let predClass = '';
                
                if(item.prob === 'High') {
                    borderColor = 'border-cyber-high';
                    glowClass = 'shadow-[0_0_15px_rgba(57,255,20,0.15)]';
                    titleColor = 'text-white neon-text-green';
                    predClass = 'text-cyber-high font-bold';
                } else if (item.prob === 'Tight') {
                    borderColor = 'border-cyber-tight';
                    glowClass = 'shadow-[0_0_15px_rgba(255,119,0,0.15)]';
                    titleColor = 'text-white neon-text-orange';
                    predClass = 'text-cyber-tight font-bold';
                } else { // Medium
                    borderColor = 'border-cyber-medium';
                    glowClass = 'shadow-[0_0_15px_rgba(252,238,10,0.15)]';
                    titleColor = 'text-white neon-text-yellow';
                    predClass = 'text-cyber-medium font-bold';
                }

                const card = document.createElement('div');
                card.className = `glass-panel rounded-lg p-5 border ${borderColor} ${glowClass} hover:scale-[1.02] transition-transform duration-300 group`;
                
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <span class="text-xs text-cyber-primary font-bold tracking-widest uppercase mb-1 block">${item.district}</span>
                            <h3 class="text-xl font-headers ${titleColor}">${item.name}</h3>
                            <span class="text-xs text-gray-500 uppercase">${item.type}</span>
                        </div>
                        <div class="bg-gray-800/50 p-2 rounded text-center min-w-[60px] border border-gray-700">
                            <div class="text-[10px] text-gray-400">LS LEAD</div>
                            <div class="text-lg font-bold text-white">${item.ls_lead}</div>
                        </div>
                    </div>
                    
                    <div class="space-y-3 mb-4">
                        <div class="flex items-center gap-2 text-sm text-gray-300">
                            <i data-lucide="users" class="w-4 h-4 text-cyber-primary"></i>
                            <span>Demography: <span class="text-white">${item.h_dem}</span></span>
                        </div>
                        <div class="flex items-center gap-2 text-sm text-gray-300">
                            <i data-lucide="target" class="w-4 h-4 text-cyber-primary"></i>
                            <span>Prediction: <span class="${predClass}">${item.prob === 'Tight' ? 'Tight Fight' : item.prob + ' Probability'}</span></span>
                        </div>
                    </div>

                    <div class="border-t border-gray-700 pt-3">
                        <p class="text-sm text-gray-400 italic leading-relaxed">"${item.note}"</p>
                    </div>
                `;
                container.appendChild(card);
            });
            
            // Re-render icons
            lucide.createIcons();
        }

        // --- CHART JS LOGIC ---

        function initCharts() {
            Chart.defaults.color = '#8585a3';
            Chart.defaults.borderColor = '#1f2937';
            Chart.defaults.font.family = 'Rajdhani';

            // 1. District Chart (Stacked Bar)
            const ctx1 = document.getElementById('districtChart').getContext('2d');
            districtChartInstance = new Chart(ctx1, {
                type: 'bar',
                data: getDistrictData(),
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { boxWidth: 10, usePointStyle: true } },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        y: { stacked: true, beginAtZero: true, grid: { color: 'rgba(255,255,255,0.05)' } },
                        x: { stacked: true, grid: { display: false } }
                    },
                    animation: { duration: 1000 }
                }
            });

            // 2. Confidence Chart (Doughnut)
            const ctx2 = document.getElementById('confidenceChart').getContext('2d');
            confidenceChartInstance = new Chart(ctx2, {
                type: 'doughnut',
                data: getConfidenceData(),
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: { position: 'right', labels: { boxWidth: 10, usePointStyle: true } }
                    },
                    layout: { padding: 10 }
                }
            });
        }

        function updateCharts() {
            // Update District Chart
            const dData = getDistrictData();
            districtChartInstance.data.labels = dData.labels;
            districtChartInstance.data.datasets = dData.datasets;
            districtChartInstance.update();

            // Update Confidence Chart
            const cData = getConfidenceData();
            confidenceChartInstance.data.datasets[0].data = cData.datasets[0].data;
            confidenceChartInstance.update();
        }

        function getDistrictData() {
            // Aggregate high, medium, tight per district
            const agg = {};
            filteredData.forEach(item => {
                if (!agg[item.district]) agg[item.district] = { High: 0, Medium: 0, Tight: 0 };
                agg[item.district][item.prob]++;
            });
            
            // Sort by total count desc
            const sortedLabels = Object.keys(agg).sort((a,b) => {
                const totalA = agg[a].High + agg[a].Medium + agg[a].Tight;
                const totalB = agg[b].High + agg[b].Medium + agg[b].Tight;
                return totalB - totalA;
            }).slice(0, 10); // Top 10

            return {
                labels: sortedLabels,
                datasets: [
                    {
                        label: 'High',
                        data: sortedLabels.map(l => agg[l].High),
                        backgroundColor: '#39ff14',
                        barPercentage: 0.6
                    },
                    {
                        label: 'Medium',
                        data: sortedLabels.map(l => agg[l].Medium),
                        backgroundColor: '#fcee0a',
                        barPercentage: 0.6
                    },
                    {
                        label: 'Tight',
                        data: sortedLabels.map(l => agg[l].Tight),
                        backgroundColor: '#ff7700',
                        barPercentage: 0.6
                    }
                ]
            };
        }

        function getConfidenceData() {
            const high = filteredData.filter(i => i.prob === 'High').length;
            const med = filteredData.filter(i => i.prob === 'Medium').length;
            const tight = filteredData.filter(i => i.prob === 'Tight').length;

            return {
                labels: ['High', 'Medium', 'Tight'],
                datasets: [{
                    data: [high, med, tight],
                    backgroundColor: ['#39ff14', '#fcee0a', '#ff7700'],
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            };
        }

        // --- UTILS ---
        function animateValue(id, start, end, duration) {
            if (start === end) return;
            const range = end - start;
            let current = start;
            const increment = end > start ? 1 : -1;
            const stepTime = Math.abs(Math.floor(duration / range));
            const obj = document.getElementById(id);
            if(!obj) return;
            
            // Clear existing interval if any
            if(obj.timer) clearInterval(obj.timer);
            
            obj.timer = setInterval(function() {
                current += increment;
                obj.innerHTML = current;
                if (current == end) {
                    clearInterval(obj.timer);
                }
            }, stepTime || 10);
        }

    </script>
</body>
</html>